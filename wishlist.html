<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wishlist - SHOEPAO</title>
    <link rel="stylesheet" href="style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body.wishlist-body {
            font-family: 'Poppins', Arial, sans-serif;
            background: #fff;
            margin: 0;
            padding: 0;
            color: #222;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }
        .wishlist-main-content {
            flex: 1 0 auto;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            min-height: 0;
            width: 100%;
        }
        .wishlist-header {
            font-family: 'Poppins', Arial, sans-serif;
            font-size: 2rem;
            font-weight: 600;
            margin-top: 48px;
            margin-bottom: 36px;
            text-align: left;
            width: 100%;
            max-width: 1200px;
        }
        .wishlist-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
            gap: 32px;
            width: 100%;
            max-width: 1200px;
            margin-bottom: 48px;
        }
        .wishlist-card {
            background: #fff;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(34,34,34,0.07);
            width: 100%;
            min-width: 260px;
            max-width: 340px;
            display: flex;
            flex-direction: column;
            align-items: stretch;
            border: 1px solid #eee;
            position: relative;
        }
        .wishlist-card-delete-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #fff;
            border: 1.5px solid #e57373;
            color: #e57373;
            border-radius: 50%;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
            font-weight: 700;
            cursor: pointer;
            transition: background 0.18s, color 0.18s, border 0.18s;
            z-index: 3;
        }
        .wishlist-card-delete-btn:hover {
            background: #e57373;
            color: #fff;
            border-color: #b71c1c;
        }
        .wishlist-card-img-box {
            position: relative;
            width: 100%;
            height: 180px;
            border-radius: 8px 8px 0 0;
            overflow: hidden;
        }
        .wishlist-card-img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        .wishlist-card-badge-sale {
            position: absolute;
            top: 14px;
            left: 14px;
            background: #b71c1c;
            color: #fff;
            font-size: 0.98rem;
            font-weight: 600;
            border-radius: 16px;
            padding: 4px 16px;
            z-index: 2;
        }
        .wishlist-card-info-box {
            background: #f7f7f7;
            border-radius: 0 0 8px 8px;
            padding: 18px 18px 12px 18px;
            display: flex;
            flex-direction: column;
            gap: 6px;
        }
        .wishlist-card-info-top {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 1.05rem;
            font-weight: 500;
        }
        .wishlist-card-brand {
            color: #222;
            font-weight: 500;
        }
        .wishlist-card-price {
            color: #222;
            font-weight: 600;
        }
        .wishlist-card-info-bottom {
            font-size: 1.08rem;
            color: #222;
            font-weight: 400;
        }
        .wishlist-divider {
            width: 100%;
            height: 2px;
            background: #eee;
            margin: 48px 0 32px 0;
        }
        .wishlist-recommend-header {
            font-size: 1.45rem;
            font-weight: 700;
            margin-bottom: 32px;
            width: 100%;
            max-width: 1200px;
        }
        .wishlist-recommend-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
            gap: 32px;
            width: 100%;
            max-width: 1200px;
            margin-bottom: 48px;
        }
        .cart-items {
            display: flex;
            flex-direction: column;
            gap: 12px;
            overflow-y: auto;
            max-height: 340px;
            padding-right: 8px;
        }
        .flip-horizontal {
            transform: scaleX(-1);
            transform-origin: center;
        }
        @media (max-width: 900px) {
            .wishlist-header, .wishlist-grid, .wishlist-recommend-header, .wishlist-recommend-grid {
                max-width: 98vw;
                margin-left: 12px;
                margin-right: 12px;
            }
        }
    </style>
</head>
<body class="wishlist-body">
    <!-- Navigation Bar (copied from orders.html, right side from product-list.html) -->
    <nav class="homepage-header" style="position:sticky;top:0;z-index:100;background:#fff;box-shadow:0 2px 8px rgba(0,0,0,0.04);padding:0 40px;display:flex;align-items:center;justify-content:space-between;height:72px;padding-left:46px;">
        <div style="display:flex;align-items:center;gap:24px;">
            <a href="home.html" style="display:flex;align-items:center;gap:30px;text-decoration:none;color:inherit;">
                <img src="IMAGE/SHOEPAOLOGO.png" alt="SHOEPAO Logo" style="height:42px;width:auto;cursor:pointer;">
                <span class="header-caption" style="font-size:1.18rem;font-weight:600;color:#b71c1c;cursor:pointer;">Shoe Pao Footwear</span>
            </a>
            <span class="header-link" onclick="goToProfile()">Profile</span>
            <span class="header-link" onclick="goToProductList()">Shop</span>
            <span class="header-link" onclick="goToOrders()">Orders</span>
            <span class="header-link" onclick="goToWishlist()">Wishlist</span>
            <span class="header-link" onclick="goToFAQ()">Policies</span>
        </div>
        <div style="display:flex;align-items:center;gap:18px;">
            <button class="header-icon-btn" onclick="toggleSearchBox()" style="background:none;border:none;padding:6px;display:flex;align-items:center;cursor:pointer;"><img src="IMAGE/SEARCHICON.png" class="header-icon" alt="Search" style="width:26px;height:26px;"></button>
            <button class="header-icon-btn" onclick="goToUserPage()" style="background:none;border:none;padding:6px;display:flex;align-items:center;cursor:pointer;"><img src="IMAGE/USERICON.png" class="header-icon" alt="User" style="width:26px;height:26px;"></button>
            <button class="header-icon-btn" id="cartToggleBtn" style="background:none;border:none;padding:6px;display:flex;align-items:center;cursor:pointer;"><img src="IMAGE/CARTICON.png" class="header-icon" alt="Cart" style="width:26px;height:26px;"></button>
        </div>
        <div class="search-box" id="searchBox" style="display:none;position:absolute;top:72px;right:80px;background:#fff;border:1px solid #ccc;border-radius:8px;padding:8px 16px;z-index:101;">
            <input type="text" class="search-input" id="searchInput" placeholder="Search products..." onkeydown="searchKeyDown(event)" style="font-family:'Poppins',Arial,sans-serif;font-size:1rem;border:none;outline:none;width:220px;padding:6px 0;">
        </div>
    </nav>
        <div class="site-container">
            <main class="wishlist-main-content">
        <div class="wishlist-header">Your Wishlist</div>
        <div class="wishlist-grid" id="wishlistGrid"></div>
        <div class="wishlist-divider"></div>
        <div class="wishlist-recommend-header">You may also like</div>
        <div class="wishlist-recommend-grid" id="wishlistRecommendGrid"></div>
    </main>
            </div>
        <footer class="footer-section">
        <div class="footer-row">
            <div class="footer-left">
                <div class="footer-header">Have questions?</div>
                <div class="footer-subheader">Contact us at our facebook page</div>
                <div class="footer-subheader" style="margin-top:18px;">Or via phone/email</div>
                <div class="footer-divider"></div>
                <div class="footer-note">All product names, logos, brands, trademarks, and registered trademarks are the property of their respective owners. All company, product, and service names used on this website are for identification purposes only. Use of these names, logos, and brands does not imply endorsement or affiliation.<br><br>© 2025 Shoe Pao Footwear. All rights reserved.</div>
            </div>
            <div class="footer-right">
                <a href="about-us.html" class="footer-link">About Us</a>
                <a href="shipping.html" class="footer-link">Shipping</a>
                <a href="returns.html" class="footer-link">Returns & Exchanges</a>
                <a href="privacy.html" class="footer-link">Privacy Policy</a>
                <a href="terms.html" class="footer-link">Terms of Service</a>
            </div>
        </div>
    </footer>
    <script>
    // Navigation bar functions
    function goToProfile() {
    try{ var p = JSON.parse(sessionStorage.getItem('profile')||localStorage.getItem('profile')||'null'); if(!p || !p.email){ window.location.href = 'login.html'; return; } }catch(e){ window.location.href = 'login.html'; return; }
        window.location.href = 'profile.html';
    }
    function goToProductList() { window.location.href = 'product-list.html'; }
    function goToOrders() { window.location.href = 'client-orders.html'; }
    function goToWishlist() { window.location.href = 'wishlist.html'; }
    function goToFAQ() { window.location.href = 'privacy.html'; }
    function goToContact() { window.location.href = 'contact.html'; }
    function goToUserPage() {
    try{ var p = JSON.parse(sessionStorage.getItem('profile')||localStorage.getItem('profile')||'null'); if(!p || !p.email){ window.location.href = 'login.html'; return; } }catch(e){ window.location.href = 'login.html'; return; }
        window.location.href = 'profile.html';
    }
    // viewProduct helper (shared behavior with product-list)
    function viewProduct(brand, name, price, img, badge) {
        try{
            localStorage.setItem('productBrand', brand || '');
            localStorage.setItem('productTitle', name || '');
            localStorage.setItem('productPrice', price || '');
            localStorage.setItem('productImg', img || '');
            localStorage.setItem('productBadge', badge || '');
        }catch(e){}
        window.location.href = 'product-view.html';
    }
    function toggleSearchBox() {
        var box = document.getElementById('searchBox');
        box.style.display = (box.style.display === 'block') ? 'none' : 'block';
        if (box.style.display === 'block') {
            document.getElementById('searchInput').focus();
        }
    }
    function searchKeyDown(e) {
        if (e.key === 'Enter') {
            var val = document.getElementById('searchInput').value.trim();
            if (val) {
                window.location.href = 'product-list.html?search=' + encodeURIComponent(val);
            }
        }
    }
    // Sticky footer fallback for short content
    function stickyFooter() {
        var body = document.body,
            html = document.documentElement,
            footer = document.querySelector('footer');
        var contentHeight = Math.max(body.scrollHeight, body.offsetHeight,
            html.clientHeight, html.scrollHeight, html.offsetHeight);
        if (contentHeight < window.innerHeight) {
            footer.style.position = 'fixed';
            footer.style.left = '0';
            footer.style.right = '0';
            footer.style.bottom = '0';
        } else {
            footer.style.position = 'relative';
        }
    }
    window.addEventListener('load', stickyFooter);
    window.addEventListener('resize', stickyFooter);

    // Wishlist logic (safe: only updates 'wishlist' key)
    function renderWishlist() {
        var wishlist = JSON.parse(localStorage.getItem('wishlist') || '[]');
        var grid = document.getElementById('wishlistGrid');
        grid.innerHTML = '';
        if (wishlist.length === 0) {
            grid.innerHTML = '<div style="color:#888;font-size:1.15rem;padding:48px 0;text-align:center;width:100%;">No items in your wishlist yet.</div>';
            return;
        }
        wishlist.forEach(function(item, idx) {
            var card = document.createElement('div');
            card.className = 'wishlist-card';
            // determine flip for Nike images
            var flipClass = ((item.brand && item.brand.toString().toLowerCase().indexOf('nike') !== -1) || (item.image && item.image.toString().toLowerCase().indexOf('nike') !== -1)) ? ' flip-horizontal' : '';
            card.innerHTML = `
                <button class="wishlist-card-delete-btn" title="Remove from Wishlist" data-idx="${idx}">&times;</button>
                <div class="wishlist-card-img-box">
                    <img src="${item.image}" class="wishlist-card-img${flipClass}" alt="${item.title}">
                    ${item.sale ? '<span class="wishlist-card-badge-sale">Sale</span>' : ''}
                </div>
                <div class="wishlist-card-info-box">
                    <div class="wishlist-card-info-top">
                        <span class="wishlist-card-brand">${item.brand}</span>
                        <span class="wishlist-card-price">${item.price}</span>
                    </div>
                    <div class="wishlist-card-info-bottom">${item.title}</div>
                </div>
            `;
            // make image and info clickable to view product (avoid clicks on delete button)
            var imgBox = card.querySelector('.wishlist-card-img-box');
            var infoBox = card.querySelector('.wishlist-card-info-box');
            function onCardClick(e){
                // if clicking the delete button, ignore
                if(e.target.closest('.wishlist-card-delete-btn')) return;
                // set product localStorage keys and navigate
                viewProduct(item.brand || '', item.title || '', item.price || '', item.image || '', item.sale ? 'Sale' : '');
            }
            if(imgBox) imgBox.style.cursor = 'pointer', imgBox.addEventListener('click', onCardClick);
            if(infoBox) infoBox.style.cursor = 'pointer', infoBox.addEventListener('click', onCardClick);
            grid.appendChild(card);
        });
        // Attach delete event
        grid.querySelectorAll('.wishlist-card-delete-btn').forEach(function(btn){
            btn.addEventListener('click', function(e){
                var idx = parseInt(btn.getAttribute('data-idx'), 10);
                var wishlist = JSON.parse(localStorage.getItem('wishlist') || '[]');
                wishlist.splice(idx, 1);
                // Only update 'wishlist' key, never clear or overwrite 'cart'
                localStorage.setItem('wishlist', JSON.stringify(wishlist));
                renderWishlist();
            });
        });
    }
    // You may also like (static demo, can be replaced with dynamic data)
    function renderWishlistRecommend() {
        var recommend = [
            {image:'IMAGE/NIKE1.png', sale:true, brand:'Nike', price:'₱2,295.00', title:'Nike P6000 Shadow'},
            {image:'IMAGE/NIKE2.png', sale:true, brand:'Nike', price:'₱2,295.00', title:'Nike Airmax TN Camo'},
            {image:'IMAGE/NIKE3.png', sale:false, brand:'Nike', price:'₱2,395.00', title:'Nike GT CUT 2 LEAP HIGH'}
        ];
        var grid = document.getElementById('wishlistRecommendGrid');
        grid.innerHTML = '';
        recommend.forEach(function(item) {
            var card = document.createElement('div');
            card.className = 'wishlist-card';
            var flipClass = ((item.brand && item.brand.toString().toLowerCase().indexOf('nike') !== -1) || (item.image && item.image.toString().toLowerCase().indexOf('nike') !== -1)) ? ' flip-horizontal' : '';
            card.innerHTML = `
                <div class="wishlist-card-img-box">
                    <img src="${item.image}" class="wishlist-card-img${flipClass}" alt="${item.title}">
                    ${item.sale ? '<span class="wishlist-card-badge-sale">New</span>' : ''}
                </div>
                <div class="wishlist-card-info-box">
                    <div class="wishlist-card-info-top">
                        <span class="wishlist-card-brand">${item.brand}</span>
                        <span class="wishlist-card-price">${item.price}</span>
                    </div>
                    <div class="wishlist-card-info-bottom">${item.title}</div>
                </div>
            `;
            // navigate to product view when clicking image or info
            var imgBox = card.querySelector('.wishlist-card-img-box');
            var infoBox = card.querySelector('.wishlist-card-info-box');
            function onRecommendClick(e){
                viewProduct(item.brand || '', item.title || '', item.price || '', item.image || '', item.sale ? 'New' : '');
            }
            if(imgBox) imgBox.style.cursor = 'pointer', imgBox.addEventListener('click', onRecommendClick);
            if(infoBox) infoBox.style.cursor = 'pointer', infoBox.addEventListener('click', onRecommendClick);
            grid.appendChild(card);
        });
    }
    window.addEventListener('DOMContentLoaded', function() {
        renderWishlist();
        renderWishlistRecommend();
    });
    </script>
    <!-- ===== Cart Overlay + Sidebar HTML (universal) ===== -->
    <div id="cartOverlay" class="cart-overlay" aria-hidden="true"></div>
    <aside id="cartSidebar" class="cart-sidebar" aria-hidden="true" role="complementary">
        <div class="cart-header-row">
            <div>
                <span class="cart-header-title">Cart (<span id="cartCount">0</span>)</span>
            </div>
            <button id="closeCartBtn" class="cart-close" aria-label="Close cart"><img src="IMAGE/X.png" alt="Close" style="width:20px;height:20px;"></button>
        </div>
        <div class="cart-divider"></div>
        <div id="cartItems" class="cart-items">
            <div class="cart-empty">Your cart is empty</div>
        </div>
        <div class="cart-divider"></div>
        <div class="cart-subtotal-row">
            <span class="cart-subtotal-label">Subtotal</span>
            <span id="cartSubtotal" class="cart-subtotal-value">₱0.00</span>
        </div>
        <button id="checkoutBtn" class="cart-checkout-btn">Checkout</button>
    </aside>
    <!-- ===== Cart Sidebar Behavior (universal) ===== -->
    <script>
    (function(){
        let cart = JSON.parse(localStorage.getItem('cart') || '[]');
        function parsePriceToNumber(priceText) {
            if (!priceText) return 0;
            var v = priceText.replace(/[^0-9.]/g, '');
            return parseFloat(v || 0);
        }
        function formatPHP(amount) {
            try {
                return new Intl.NumberFormat('en-PH', { style: 'currency', currency: 'PHP' }).format(amount);
            } catch (e) {
                return '₱' + Number(amount).toFixed(2);
            }
        }
        function saveCartToLocalStorage() {
            localStorage.setItem('cart', JSON.stringify(cart));
        }
        const cartOverlay = document.getElementById('cartOverlay');
        const cartSidebar = document.getElementById('cartSidebar');
        const cartItemsContainer = document.getElementById('cartItems');
        const cartCountEl = document.getElementById('cartCount');
        const cartSubtotalEl = document.getElementById('cartSubtotal');
        const closeCartBtn = document.getElementById('closeCartBtn');
        const checkoutBtn = document.getElementById('checkoutBtn');
        function getNavCartButton() {
            const img = document.querySelector('img[alt="Cart"]');
            if (!img) return null;
            return img.closest('button');
        }
        function openCartSidebar() {
            cartOverlay.classList.add('show');
            cartSidebar.classList.add('open');
            document.body.style.overflow = 'hidden';
            cartSidebar.setAttribute('aria-hidden', 'false');
            cartOverlay.setAttribute('aria-hidden', 'false');
        }
        function closeCartSidebar() {
            cartOverlay.classList.remove('show');
            cartSidebar.classList.remove('open');
            document.body.style.overflow = '';
            cartSidebar.setAttribute('aria-hidden', 'true');
            cartOverlay.setAttribute('aria-hidden', 'true');
        }
        function renderCart() {
            cartItemsContainer.innerHTML = '';
            if (cart.length === 0) {
                const empty = document.createElement('div');
                empty.className = 'cart-empty';
                empty.textContent = 'Your cart is empty';
                cartItemsContainer.appendChild(empty);
                cartCountEl.textContent = 0;
                cartSubtotalEl.textContent = formatPHP(0);
                saveCartToLocalStorage();
                return;
            }
            let subtotal = 0;
            let totalQty = 0;
            cart.forEach((item, index) => {
                subtotal += item.price * item.quantity;
                totalQty += item.quantity;
                const box = document.createElement('div');
                box.className = 'cart-item-box';
                const img = document.createElement('img');
                img.className = 'cart-item-img';
                img.src = item.image || 'IMAGE/NIKE1.png';
                img.alt = item.title || 'Product';
                const middle = document.createElement('div');
                middle.className = 'cart-item-middle';
                const title = document.createElement('div');
                title.className = 'cart-item-title';
                title.textContent = item.title;
                const brand = document.createElement('div');
                brand.className = 'cart-item-brand';
                brand.textContent = item.brand;
                const size = document.createElement('div');
                size.className = 'cart-item-size';
                size.textContent = 'Size: ' + (item.size || '');
                const qtyControls = document.createElement('div');
                qtyControls.className = 'cart-quantity-controls';
                const lessenBtn = document.createElement('button');
                lessenBtn.className = 'qty-btn decrease';
                lessenBtn.setAttribute('data-index', index);
                const lessenImg = document.createElement('img');
                lessenImg.src = 'IMAGE/LessenBTN.png';
                lessenImg.alt = '-';
                lessenImg.style.width = '22px';
                lessenImg.style.height = '22px';
                lessenBtn.appendChild(lessenImg);
                const qtyText = document.createElement('span');
                qtyText.className = 'cart-item-qty';
                qtyText.textContent = item.quantity;
                const addBtn = document.createElement('button');
                addBtn.className = 'qty-btn increase';
                addBtn.setAttribute('data-index', index);
                const addImg = document.createElement('img');
                addImg.src = 'IMAGE/AddBTN.png';
                addImg.alt = '+';
                addImg.style.width = '22px';
                addImg.style.height = '22px';
                addBtn.appendChild(addImg);
                qtyControls.appendChild(lessenBtn);
                qtyControls.appendChild(qtyText);
                qtyControls.appendChild(addBtn);
                middle.appendChild(title);
                middle.appendChild(brand);
                middle.appendChild(size);
                middle.appendChild(qtyControls);
                const removeBtn = document.createElement('button');
                removeBtn.className = 'cart-item-remove';
                removeBtn.setAttribute('data-index', index);
                const trashImg = document.createElement('img');
                trashImg.src = 'IMAGE/TrashIcon.png';
                trashImg.alt = 'Remove';
                trashImg.style.width = '18px';
                trashImg.style.height = '18px';
                removeBtn.appendChild(trashImg);
                const priceEl = document.createElement('div');
                priceEl.className = 'cart-item-price';
                priceEl.textContent = formatPHP(item.price * item.quantity);
                box.appendChild(img);
                box.appendChild(middle);
                box.appendChild(removeBtn);
                box.appendChild(priceEl);
                cartItemsContainer.appendChild(box);
            });
            cartCountEl.textContent = totalQty;
            cartSubtotalEl.textContent = formatPHP(subtotal);
            attachCartEvents();
        }
        function attachCartEvents() {
            document.querySelectorAll('.qty-btn.decrease').forEach(btn => {
                btn.onclick = function(e) {
                    const idx = parseInt(btn.getAttribute('data-index'), 10);
                    if (!isNaN(idx) && cart[idx]) {
                        if (cart[idx].quantity > 1) {
                            cart[idx].quantity--;
                        }
                        renderCart();
                        saveCartToLocalStorage();
                    }
                };
            });
            document.querySelectorAll('.qty-btn.increase').forEach(btn => {
                btn.onclick = function(e) {
                    const idx = parseInt(btn.getAttribute('data-index'), 10);
                    if (!isNaN(idx) && cart[idx]) {
                        cart[idx].quantity++;
                        renderCart();
                        saveCartToLocalStorage();
                    }
                };
            });
            document.querySelectorAll('.cart-item-remove').forEach(btn => {
                btn.onclick = function(e) {
                    const idx = parseInt(btn.getAttribute('data-index'), 10);
                    if (!isNaN(idx)) {
                        cart.splice(idx, 1);
                        renderCart();
                        saveCartToLocalStorage();
                    }
                };
            });
        }
        document.addEventListener('DOMContentLoaded', function() {
            const navCartBtn = getNavCartButton();
            if (navCartBtn) {
                navCartBtn.removeAttribute('onclick');
                navCartBtn.addEventListener('click', function(e){
                    e.preventDefault();
                    openCartSidebar();
                });
            }
            if (closeCartBtn) closeCartBtn.addEventListener('click', closeCartSidebar);
            if (cartOverlay) cartOverlay.addEventListener('click', closeCartSidebar);
            renderCart();
            if (checkoutBtn) {
                checkoutBtn.addEventListener('click', function(){
                    window.location.href = 'checkout.html';
                });
            }
        });
    })();
    </script>
    <script src="cart-storage.js"></script>
</body>
</html>
