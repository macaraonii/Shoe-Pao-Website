<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profile - SHOEPAO</title>
    <link rel="stylesheet" href="style.css">
    <style>
        body {
            font-family: 'Poppins', Arial, sans-serif;
            background: #fff;
            margin: 0;
            padding: 0;
            color: #222;
        }
        .orders-navbar-logo {
            height: 38px;
            width: auto;
            cursor: pointer;
        }
        .profile-main {
            max-width: 700px;
            margin: 48px auto 0 auto;
            padding-bottom: 0;
        }
        .profile-header {
            font-size: 2rem;
            font-weight: 600;
            margin-bottom: 18px;
            font-family: 'Poppins', Arial, sans-serif;
        }
        .profile-divider {
            width: 100%;
            height: 2px;
            background: #eee;
            margin: 0 0 24px 0;
        }
        .profile-label {
            font-size: 1.08rem;
            font-weight: 500;
            color: #222;
            margin-bottom: 6px;
        }
        .profile-input {
            width: 100%;
            font-size: 1.08rem;
            font-family: 'Poppins', Arial, sans-serif;
            color: #222;
            background: #fff;
            border: none;
            border-radius: 8px;
            padding: 10px 16px;
            margin-bottom: 18px;
            box-shadow: 0 1px 4px rgba(34,34,34,0.07);
            border: 1px solid #eee;
        }
        .profile-input:focus {
            outline: none;
            border: 1.5px solid #b71c1c;
            background: #f7f7f7;
        }
        .profile-address-box {
            background: #f5f5f5;
            border-radius: 10px;
            padding: 14px 18px 10px 18px;
            margin-bottom: 8px;
            font-size: 1.05rem;
            color: #222;
            display: flex;
            flex-direction: column;
            gap: 2px;
        }
        .profile-address-main {
            font-weight: 500;
            color: #222;
        }
        .profile-address-details {
            font-size: 0.98rem;
            color: #444;
        }
        .profile-address-row {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 18px;
        }
        .profile-address-plus {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 1.05rem;
            color: #222;
            cursor: pointer;
            font-weight: 500;
            margin-top: 2px;
        }
        .profile-address-plus img {
            width: 22px;
            height: 22px;
        }
        .profile-phone-row {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 18px;
        }
        .profile-phone-prefix {
            color: #444;
            font-size: 1.08rem;
            pointer-events: none;
            margin-right: 8px; /* reduced by 20px to make the gap smaller */
        }
        /* decorative marker removed for consistent layout */
        .profile-phone-input {
            border: none;
            outline: none;
            font-size: 1.08rem;
            background: #fff;
            color: #222;
            font-family: 'Poppins', Arial, sans-serif;
            border-radius: 8px;
            padding: 10px 16px;
            box-shadow: 0 1px 4px rgba(34,34,34,0.07);
            border: 1px solid #eee;
            width: 100%;
        }
        .profile-phone-input:focus {
            border: 1.5px solid #b71c1c;
            background: #f7f7f7;
        }
        .profile-section-divider {
            width: 100%;
            height: 2px;
            background: #eee;
            margin: 24px 0 24px 0;
        }
        .profile-security-header {
            font-size: 1.18rem;
            font-weight: 600;
            margin-bottom: 18px;
            color: #222;
        }
        .profile-password-label {
            font-size: 1.05rem;
            color: #444;
            font-weight: 500;
            margin-bottom: 6px;
        }
        .profile-password-row {
            position: relative;
            margin-bottom: 18px;
        }
        .profile-password-input {
            width: 100%;
            font-size: 1.08rem;
            font-family: 'Poppins', Arial, sans-serif;
            color: #222;
            background: #fff;
            border: none;
            border-radius: 8px;
            padding: 10px 16px;
            box-shadow: 0 1px 4px rgba(34,34,34,0.07);
            border: 1px solid #eee;
            letter-spacing: 2px;
        }
        .profile-password-input:focus {
            outline: none;
            border: 1.5px solid #b71c1c;
            background: #f7f7f7;
        }
        .profile-password-toggle {
            position: absolute;
            top: 50%;
            right: 16px;
            transform: translateY(-50%);
            display: flex;
            align-items: center;
            gap: 4px;
            font-size: 1.01rem;
            color: #888;
            cursor: pointer;
            user-select: none;
        }
        .profile-password-toggle img {
            width: 18px;
            height: 18px;
        }
        .profile-save-btn {
            background: #222;
            color: #fff;
            border: none;
            border-radius: 22px;
            padding: 12px 0;
            width: 120px;
            font-size: 1.08rem;
            font-family: 'Poppins', Arial, sans-serif;
            font-weight: 500;
            cursor: pointer;
            transition: background 0.2s, box-shadow 0.2s;
            box-shadow: 0 2px 8px rgba(34,34,34,0.10);
            margin: 32px auto 48px auto;
            display: block;
        }
        .profile-save-btn:hover {
            background: #b71c1c;
        }
        .profile-signout-btn {
            background: transparent;
            color: #b71c1c;
            border: 1.5px solid #b71c1c;
            border-radius: 22px;
            padding: 10px 0;
            width: 120px;
            font-size: 1.02rem;
            font-family: 'Poppins', Arial, sans-serif;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.15s, color 0.15s;
            margin: 8px auto 36px auto;
            display: block;
        }
        .profile-signout-btn:hover { background: #b71c1c; color: #fff; }
        @media (max-width: 900px) {
            .profile-main {
                max-width: 98vw;
                margin: 24px 2vw 0 2vw;
                padding-bottom: 180px;
            }
        }
    </style>
</head>
<body class="profile-body">
    <!-- Navigation Bar -->
    <nav class="homepage-header" style="position:sticky;top:0;z-index:100;background:#fff;box-shadow:0 2px 8px rgba(0,0,0,0.04);padding:0 40px;display:flex;align-items:center;justify-content:space-between;height:72px;padding-left:46px;">
        <div style="display:flex;align-items:center;gap:24px;">
            <a href="home.html" style="display:flex;align-items:center;gap:30px;text-decoration:none;color:inherit;">
                <img src="IMAGE/SHOEPAOLOGO.png" alt="SHOEPAO Logo" style="height:42px;width:auto;cursor:pointer;">
                <span class="header-caption" style="font-size:1.18rem;font-weight:600;color:#b71c1c;cursor:pointer;">Shoe Pao Footwear</span>
            </a>
            <span class="header-link" onclick="goToProfile()">Profile</span>
            <span class="header-link" onclick="goToProductList()">Shop</span>
            <span class="header-link" onclick="goToOrders()">Orders</span>
            <span class="header-link" onclick="goToWishlist()">Wishlist</span>
            <span class="header-link" onclick="goToFAQ()">Policies</span>
        </div>
        <div style="display:flex;align-items:center;gap:18px;">
            <button class="header-icon-btn" onclick="toggleSearchBox()" style="background:none;border:none;padding:6px;display:flex;align-items:center;cursor:pointer;"><img src="IMAGE/SEARCHICON.png" class="header-icon" alt="Search" style="width:26px;height:26px;"></button>
            <button class="header-icon-btn" onclick="goToUserPage()" style="background:none;border:none;padding:6px;display:flex;align-items:center;cursor:pointer;"><img src="IMAGE/USERICON.png" class="header-icon" alt="User" style="width:26px;height:26px;"></button>
            <button class="header-icon-btn" onclick="goToCartPage()" style="background:none;border:none;padding:6px;display:flex;align-items:center;cursor:pointer;"><img src="IMAGE/CARTICON.png" class="header-icon" alt="Cart" style="width:26px;height:26px;"></button>
        </div>
        <div class="search-box" id="searchBox" style="display:none;position:absolute;top:72px;right:80px;background:#fff;border:1px solid #ccc;border-radius:8px;padding:8px 16px;z-index:101;">
            <input type="text" class="search-input" id="searchInput" placeholder="Search products..." onkeydown="searchKeyDown(event)" style="font-family:'Poppins',Arial,sans-serif;font-size:1rem;border:none;outline:none;width:220px;padding:6px 0;">
        </div>
    </nav>
    <div class="site-container">
    <div class="profile-main">
        <div class="profile-header">Profile</div>
        <div class="profile-divider"></div>
        <div class="profile-label">Name</div>
        <input type="text" id="profileName" class="profile-input" value="Jemar Eden">
        <div class="profile-divider"></div>
        <div class="profile-label">Email</div>
        <input type="email" id="profileEmail" class="profile-input" value="useraccount@gmail.com">
        <div class="profile-label">Address</div>
        <div class="profile-address-box">
            <div class="profile-address-main" id="profileAddressMain">Jemar Eden, BLK 69 LOT 18 Fairview</div>
            <div class="profile-address-details" id="profileAddressDetails">QUEZON CITY, 1118, PH</div>
        </div>
        <div class="profile-address-plus" onclick="addAddress()"><img src="IMAGE/Plus.png" alt="Plus">Use a different address</div>
        <div id="profileAddressEditor" style="display:none;margin-top:10px"> 
            <div class="profile-label">Edit address</div>
            <textarea id="profileAddressTextarea" rows="3" class="profile-input" placeholder="Enter full shipping address (street, barangay, city/province, postal code)"></textarea>
            <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:8px;">
                <button id="profileAddressCancel" style="padding:8px 12px;border-radius:8px;border:1px solid #ddd;background:#fff;cursor:pointer">Cancel</button>
                <button id="profileAddressSave" style="padding:8px 12px;border-radius:8px;border:0;background:#000;color:#fff;cursor:pointer">Save</button>
            </div>
        </div>
        <div class="profile-section-divider"></div>
        <div class="profile-label">Contact Number</div>
        <div class="profile-phone-row">
            <span class="profile-phone-prefix">+63</span>
            <input type="text" id="profilePhone" class="profile-phone-input" maxlength="12" pattern="[0-9]{3} [0-9]{3} [0-9]{4}" placeholder="xxx xxx xxxx" value="917 265 5421" oninput="formatPhone(this)">
        </div>
        <div class="profile-section-divider"></div>
        <div class="profile-security-header">Security</div>
        <div class="profile-password-label">Change password</div>
        <div class="profile-password-label" style="font-size:0.98rem;font-weight:400;">Current Password</div>
        <div class="profile-password-row">
            <input type="password" id="currentPassword" class="profile-password-input">
            <span class="profile-password-toggle" onclick="togglePassword('currentPassword', this)"><img src="IMAGE/ToggleHideButton.png" alt="Hide"> Hide</span>
        </div>
        <div class="profile-password-label" style="font-size:0.98rem;font-weight:400;">New Password</div>
        <div class="profile-password-row">
            <input type="password" id="newPassword" class="profile-password-input">
            <span class="profile-password-toggle" onclick="togglePassword('newPassword', this)"><img src="IMAGE/ToggleHideButton.png" alt="Hide"> Hide</span>
        </div>
        <div class="profile-password-label" style="font-size:0.98rem;font-weight:400;">Confirm Password</div>
        <div class="profile-password-row">
            <input type="password" id="confirmPassword" class="profile-password-input">
            <span class="profile-password-toggle" onclick="togglePassword('confirmPassword', this)"><img src="IMAGE/ToggleHideButton.png" alt="Hide"> Hide</span>
        </div>
    <button class="profile-save-btn" onclick="saveProfile()">Save</button>
    <button class="profile-signout-btn" id="signOutBtn" onclick="signOut()">Sign Out</button>
                </div>
            </div>
            <footer class="footer-section">
                <div class="footer-row">
                        <div class="footer-left">
                                <div class="footer-header">Have questions?</div>
                                <div class="footer-subheader">Contact us at our facebook page</div>
                                <div class="footer-subheader" style="margin-top:18px;">Or via phone/email</div>
                                <div class="footer-divider"></div>
                                <div class="footer-note">All product names, logos, brands, trademarks, and registered trademarks are the property of their respective owners. All company, product, and service names used on this website are for identification purposes only. Use of these names, logos, and brands does not imply endorsement or affiliation.<br><br>© 2025 Shoe Pao Footwear. All rights reserved.</div>
                        </div>
                        <div class="footer-right">
                                <a href="#" class="footer-link">About Us</a>
                                <a href="#" class="footer-link">Shipping</a>
                                <a href="#" class="footer-link">Returns & Exchanges</a>
                                <a href="#" class="footer-link">Privacy Policy</a>
                                <a href="#" class="footer-link">Terms of Service</a>
                        </div>
                </div>
        </footer>

    <script>
    // Navigation bar functions
    function goToHome() { window.location.href = 'home.html'; }
    function goToProfile() {
    try{ var p = JSON.parse(sessionStorage.getItem('profile')||localStorage.getItem('profile')||'null'); if(!p || !p.email){ window.location.href = 'login.html'; return; } }catch(e){ window.location.href = 'login.html'; return; }
        window.location.href = 'profile.html';
    }
    function goToProductList() { window.location.href = 'product-list.html'; }
    function goToOrders() { window.location.href = 'client-orders.html'; }
    function goToWishlist() { window.location.href = 'wishlist.html'; }
    function goToFAQ() { window.location.href = 'policy.html'; }
    function goToContact() { window.location.href = 'contact.html'; }
    function goToUserPage() {
    try{ var p = JSON.parse(sessionStorage.getItem('profile')||localStorage.getItem('profile')||'null'); if(!p || !p.email){ window.location.href = 'login.html'; return; } }catch(e){ window.location.href = 'login.html'; return; }
        window.location.href = 'profile.html';
    }
    function goToCartPage() { window.location.href = 'cart.html'; }
    function toggleSearchBox() {
        var box = document.getElementById('searchBox');
        box.style.display = (box.style.display === 'block') ? 'none' : 'block';
        if (box.style.display === 'block') {
            document.getElementById('searchInput').focus();
        }
    }
    function searchKeyDown(e) {
        if (e.key === 'Enter') {
            var val = document.getElementById('searchInput').value.trim();
            if (val) {
                window.location.href = 'product-list.html?search=' + encodeURIComponent(val);
            }
        }
    }
    // Phone formatting (same as signup)
    function formatPhone(input) {
        // Format as 3-3-4 (xxx xxx xxxx)
        let value = input.value.replace(/\D/g, '');
        let formatted = '';
        if (value.length > 0) {
            formatted += value.substring(0,3);
        }
        if (value.length > 3) {
            formatted += ' ' + value.substring(3,6);
        }
        if (value.length > 6) {
            formatted += ' ' + value.substring(6,10);
        }
        input.value = formatted;
    }
    // Password toggle
    function togglePassword(id, el) {
        var input = document.getElementById(id);
        if (input.type === 'password') {
            input.type = 'text';
            el.innerHTML = '<img src="IMAGE/ToggleHideButton.png" alt="Hide"> Show';
        } else {
            input.type = 'password';
            el.innerHTML = '<img src="IMAGE/ToggleHideButton.png" alt="Hide"> Hide';
        }
    }
    // Save profile (persist to localStorage)
    function saveProfile() {
        var name = document.getElementById('profileName').value.trim();
        var email = document.getElementById('profileEmail').value.trim();
        var addressMain = document.getElementById('profileAddressMain') ? document.getElementById('profileAddressMain').textContent.trim() : '';
        var addressDetails = document.getElementById('profileAddressDetails') ? document.getElementById('profileAddressDetails').textContent.trim() : '';
        var phone = document.getElementById('profilePhone').value.trim();
        var newPassword = document.getElementById('newPassword').value.trim();
        var confirmPassword = document.getElementById('confirmPassword').value.trim();
        if (newPassword.length > 0) {
            if (newPassword !== confirmPassword) {
                alert('New password and confirm password do not match.');
                document.getElementById('confirmPassword').focus();
                return;
            }
        }
        var profile = {
            name: name,
            email: email,
            addressMain: addressMain,
            addressDetails: addressDetails,
            phone: phone
        };
        try {
            localStorage.setItem('profile', JSON.stringify(profile));
            // also update users list so admin/accounts page reflects changes
            try{
                var users = JSON.parse(localStorage.getItem('users') || '[]');
                var found = false;
                if(Array.isArray(users)){
                    for(var i=0;i<users.length;i++){
                        if((users[i].email||'').toLowerCase() === (profile.email||'').toLowerCase()){
                            users[i].name = profile.name || users[i].name;
                            // split name into first/last when possible
                            var parts = (profile.name||'').trim().split(/\s+/);
                            if(parts.length>0) users[i].firstName = parts[0];
                            if(parts.length>1) users[i].lastName = parts.slice(1).join(' ');
                            users[i].phone = profile.phone || users[i].phone;
                            users[i].addressMain = profile.addressMain || users[i].addressMain;
                            users[i].addressDetails = profile.addressDetails || users[i].addressDetails;
                            found = true;
                            break;
                        }
                    }
                }
                if(!found){
                    // create a minimal user entry so accounts list shows this profile
                    users.push({ email: profile.email || '', name: profile.name || '', firstName: (profile.name||'').split(/\s+/)[0]||'', lastName: (profile.name||'').split(/\s+/).slice(1).join(' ')||'', phone: profile.phone || '', role: 'user', registeredAt: Date.now() });
                }
                localStorage.setItem('users', JSON.stringify(users));
            }catch(err){ /* ignore users update errors */ }
            // Backfill existing orders that don't have a customerName
            try{
                var orders = JSON.parse(localStorage.getItem('orders') || '[]');
                var updated = 0;
                if(Array.isArray(orders) && orders.length){
                    for(var i=0;i<orders.length;i++){
                        if(!orders[i].customerName || orders[i].customerName.trim() === ''){
                            orders[i].customerName = profile.name || '';
                            updated++;
                        }
                    }
                    if(updated>0) localStorage.setItem('orders', JSON.stringify(orders));
                }
            }catch(err){/* ignore orders parse errors */}
            alert('Profile saved!' + (typeof updated !== 'undefined' && updated>0 ? ('\nBackfilled ' + updated + ' existing order(s)') : ''));
        } catch (e) {
            console.error('Could not save profile to localStorage', e);
            alert('Unable to save profile locally.');
        }
    }

    // Sign out: clear saved profile and redirect to login page
    function signOut() {
        try {
            localStorage.removeItem('profile');
        } catch (e) {
            console.warn('Could not remove profile from localStorage', e);
        }
        // Optionally clear other session data if you want a full sign-out
        // localStorage.removeItem('cart');
        // localStorage.removeItem('checkoutPackaging');
        window.location.href = 'login.html';
    }
    // Populate profile inputs from localStorage if available and auto-save on change
    document.addEventListener('DOMContentLoaded', function(){
        try{
            var p = JSON.parse(sessionStorage.getItem('profile') || localStorage.getItem('profile') || 'null');
            if(p){
                if(document.getElementById('profileName')) document.getElementById('profileName').value = p.name || '';
                if(document.getElementById('profileEmail')) document.getElementById('profileEmail').value = p.email || '';
                if(document.getElementById('profileAddressMain')) document.getElementById('profileAddressMain').textContent = p.addressMain || '';
                if(document.getElementById('profileAddressDetails')) document.getElementById('profileAddressDetails').textContent = p.addressDetails || '';
                if(document.getElementById('profilePhone')) document.getElementById('profilePhone').value = p.phone || '';
            }
        }catch(err){/* ignore parse errors */}

        // Debounced autosave when user types in profile fields so orders can pick up the name
        function debounce(fn, wait){
            var t;
            return function(){
                var args = arguments;
                clearTimeout(t);
                t = setTimeout(function(){ fn.apply(null, args); }, wait);
            }
        }

        function autosaveProfile(){
            var nameEl = document.getElementById('profileName');
            var emailEl = document.getElementById('profileEmail');
            var addrMainEl = document.getElementById('profileAddressMain');
            var addrDetEl = document.getElementById('profileAddressDetails');
            var phoneEl = document.getElementById('profilePhone');
            var profile = {
                name: nameEl ? nameEl.value.trim() : '',
                email: emailEl ? emailEl.value.trim() : '',
                addressMain: addrMainEl ? addrMainEl.textContent.trim() : '',
                addressDetails: addrDetEl ? addrDetEl.textContent.trim() : '',
                phone: phoneEl ? phoneEl.value.trim() : ''
            };
            try{ localStorage.setItem('profile', JSON.stringify(profile)); }catch(e){/* ignore */}
        }

        var debouncedAutosave = debounce(autosaveProfile, 600);
        ['profileName','profileEmail','profilePhone'].forEach(function(id){
            var el = document.getElementById(id);
            if(el) el.addEventListener('input', debouncedAutosave);
        });
        // update UI when profile changes in another tab/window (listen to profile or a timestamp key)
        window.addEventListener('storage', function(e){
            try{
                if(e.key === 'profile' || e.key === 'profile_updated_at' || e.key === 'profile_updated_at_session'){
                    // prefer sessionStorage when present, fall back to localStorage
                    var np = JSON.parse(sessionStorage.getItem('profile') || localStorage.getItem('profile') || 'null');
                    if(np){
                        if(document.getElementById('profileName')) document.getElementById('profileName').value = np.name || '';
                        if(document.getElementById('profileEmail')) document.getElementById('profileEmail').value = np.email || '';
                        if(document.getElementById('profileAddressMain')) document.getElementById('profileAddressMain').textContent = np.addressMain || '';
                        if(document.getElementById('profileAddressDetails')) document.getElementById('profileAddressDetails').textContent = np.addressDetails || '';
                        if(document.getElementById('profilePhone')) document.getElementById('profilePhone').value = np.phone || '';
                    }
                }
            }catch(ex){/* ignore */}
        });
    });
    // Add address (stub)
    function addAddress() {
        var editor = document.getElementById('profileAddressEditor');
        var ta = document.getElementById('profileAddressTextarea');
        var main = document.getElementById('profileAddressMain');
        var details = document.getElementById('profileAddressDetails');
        if(!editor) return;
        if(editor.style.display === 'none' || editor.style.display === ''){
            // open and preload from current address
            ta.value = (main ? main.textContent.trim() : '') + (details && details.textContent ? ('\n' + details.textContent.trim()) : '');
            editor.style.display = 'block';
            ta.focus();
            // wire buttons
            var saveBtn = document.getElementById('profileAddressSave');
            var cancelBtn = document.getElementById('profileAddressCancel');
            if(saveBtn){ saveBtn.onclick = function(){ saveProfileAddress(); }; }
            if(cancelBtn){ cancelBtn.onclick = function(){ editor.style.display = 'none'; }; }
        } else {
            editor.style.display = 'none';
        }
    }

    function saveProfileAddress(){
        var ta = document.getElementById('profileAddressTextarea');
        var val = (ta ? ta.value.trim() : '');
        var main = document.getElementById('profileAddressMain');
        var details = document.getElementById('profileAddressDetails');
        var editor = document.getElementById('profileAddressEditor');
        var addrMain = '';
        var addrDetails = '';
        if(val){
            addrMain = val.split('\n')[0] || val;
            addrDetails = val.split('\n').slice(1).join(', ') || '';
            if(main) main.textContent = addrMain;
            if(details) details.textContent = addrDetails;
        } else {
            if(main) main.textContent = '';
            if(details) details.textContent = '';
        }
        // persist to profile and users list
        try{
            var p = JSON.parse(sessionStorage.getItem('profile') || localStorage.getItem('profile') || '{}') || {};
            p.addressMain = addrMain; p.addressDetails = addrDetails;
            localStorage.setItem('profile', JSON.stringify(p));
        }catch(e){}
        try{
            var users = JSON.parse(localStorage.getItem('users') || '[]') || [];
            var email = (document.getElementById('profileEmail') && document.getElementById('profileEmail').value) ? document.getElementById('profileEmail').value.trim().toLowerCase() : '';
            if(email){
                for(var i=0;i<users.length;i++){
                    if((users[i].email||'').toLowerCase() === email){
                        users[i].addressMain = addrMain || users[i].addressMain;
                        users[i].addressDetails = addrDetails || users[i].addressDetails;
                        break;
                    }
                }
                localStorage.setItem('users', JSON.stringify(users));
            }
        }catch(e){}
        if(editor) editor.style.display = 'none';
        alert('Address saved');
    }
    // Sticky footer fallback for short content
    function stickyFooter() {
        var body = document.body,
            html = document.documentElement,
            footer = document.querySelector('footer');
        var contentHeight = Math.max(body.scrollHeight, body.offsetHeight,
            html.clientHeight, html.scrollHeight, html.offsetHeight);
        if (contentHeight < window.innerHeight) {
            footer.style.position = 'fixed';
            footer.style.left = '0';
            footer.style.right = '0';
            footer.style.bottom = '0';
        } else {
            footer.style.position = 'relative';
        }
    }
    window.addEventListener('load', stickyFooter);
    window.addEventListener('resize', stickyFooter);
    </script>

</body>

    <!-- ===== Cart Overlay + Sidebar HTML (universal) ===== -->
    <div id="cartOverlay" class="cart-overlay" aria-hidden="true"></div>
    <aside id="cartSidebar" class="cart-sidebar" aria-hidden="true" role="complementary">
        <div class="cart-header-row">
            <div>
                <span class="cart-header-title">Cart (<span id="cartCount">0</span>)</span>
            </div>
            <button id="closeCartBtn" class="cart-close" aria-label="Close cart"><img src="IMAGE/X.png" alt="Close" style="width:20px;height:20px;"></button>
        </div>
        <div class="cart-divider"></div>
        <div id="cartItems" class="cart-items">
            <div class="cart-empty">Your cart is empty</div>
        </div>
        <div class="cart-divider"></div>
        <div class="cart-subtotal-row">
            <span class="cart-subtotal-label">Subtotal</span>
            <span id="cartSubtotal" class="cart-subtotal-value">₱0.00</span>
        </div>
        <button id="checkoutBtn" class="cart-checkout-btn">Checkout</button>
    </aside>
    <!-- ===== Cart Sidebar Behavior (universal) ===== -->
    <script>
    (function(){
        let cart = JSON.parse(localStorage.getItem('cart') || '[]');
        function parsePriceToNumber(priceText) {
            if (!priceText) return 0;
            var v = priceText.replace(/[^0-9.]/g, '');
            return parseFloat(v || 0);
        }
        function formatPHP(amount) {
            try {
                return new Intl.NumberFormat('en-PH', { style: 'currency', currency: 'PHP' }).format(amount);
            } catch (e) {
                return '₱' + Number(amount).toFixed(2);
            }
        }
        function saveCartToLocalStorage() {
            localStorage.setItem('cart', JSON.stringify(cart));
        }
        const cartOverlay = document.getElementById('cartOverlay');
        const cartSidebar = document.getElementById('cartSidebar');
        const cartItemsContainer = document.getElementById('cartItems');
        const cartCountEl = document.getElementById('cartCount');
        const cartSubtotalEl = document.getElementById('cartSubtotal');
        const closeCartBtn = document.getElementById('closeCartBtn');
        const checkoutBtn = document.getElementById('checkoutBtn');
        function getNavCartButton() {
            const img = document.querySelector('img[alt="Cart"]');
            if (!img) return null;
            return img.closest('button');
        }
        function openCartSidebar() {
            cartOverlay.classList.add('show');
            cartSidebar.classList.add('open');
            document.body.style.overflow = 'hidden';
            cartSidebar.setAttribute('aria-hidden', 'false');
            cartOverlay.setAttribute('aria-hidden', 'false');
        }
        function closeCartSidebar() {
            cartOverlay.classList.remove('show');
            cartSidebar.classList.remove('open');
            document.body.style.overflow = '';
            cartSidebar.setAttribute('aria-hidden', 'true');
            cartOverlay.setAttribute('aria-hidden', 'true');
        }
        function renderCart() {
            cartItemsContainer.innerHTML = '';
            if (cart.length === 0) {
                const empty = document.createElement('div');
                empty.className = 'cart-empty';
                empty.textContent = 'Your cart is empty';
                cartItemsContainer.appendChild(empty);
                cartCountEl.textContent = 0;
                cartSubtotalEl.textContent = formatPHP(0);
                saveCartToLocalStorage();
                return;
            }
            let subtotal = 0;
            let totalQty = 0;
            cart.forEach((item, index) => {
                subtotal += item.price * item.quantity;
                totalQty += item.quantity;
                const box = document.createElement('div');
                box.className = 'cart-item-box';
                const img = document.createElement('img');
                img.className = 'cart-item-img';
                img.src = item.image || 'IMAGE/NIKE1.png';
                img.alt = item.title || 'Product';
                const middle = document.createElement('div');
                middle.className = 'cart-item-middle';
                const title = document.createElement('div');
                title.className = 'cart-item-title';
                title.textContent = item.title;
                const brand = document.createElement('div');
                brand.className = 'cart-item-brand';
                brand.textContent = item.brand;
                const size = document.createElement('div');
                size.className = 'cart-item-size';
                size.textContent = 'Size: ' + (item.size || '');
                const qtyControls = document.createElement('div');
                qtyControls.className = 'cart-quantity-controls';
                const lessenBtn = document.createElement('button');
                lessenBtn.className = 'qty-btn decrease';
                lessenBtn.setAttribute('data-index', index);
                const lessenImg = document.createElement('img');
                lessenImg.src = 'IMAGE/LessenBTN.png';
                lessenImg.alt = '-';
                lessenImg.style.width = '22px';
                lessenImg.style.height = '22px';
                lessenBtn.appendChild(lessenImg);
                const qtyText = document.createElement('span');
                qtyText.className = 'cart-item-qty';
                qtyText.textContent = item.quantity;
                const addBtn = document.createElement('button');
                addBtn.className = 'qty-btn increase';
                addBtn.setAttribute('data-index', index);
                const addImg = document.createElement('img');
                addImg.src = 'IMAGE/AddBTN.png';
                addImg.alt = '+';
                addImg.style.width = '22px';
                addImg.style.height = '22px';
                addBtn.appendChild(addImg);
                qtyControls.appendChild(lessenBtn);
                qtyControls.appendChild(qtyText);
                qtyControls.appendChild(addBtn);
                middle.appendChild(title);
                middle.appendChild(brand);
                middle.appendChild(size);
                middle.appendChild(qtyControls);
                const removeBtn = document.createElement('button');
                removeBtn.className = 'cart-item-remove';
                removeBtn.setAttribute('data-index', index);
                const trashImg = document.createElement('img');
                trashImg.src = 'IMAGE/TrashIcon.png';
                trashImg.alt = 'Remove';
                trashImg.style.width = '18px';
                trashImg.style.height = '18px';
                removeBtn.appendChild(trashImg);
                const priceEl = document.createElement('div');
                priceEl.className = 'cart-item-price';
                priceEl.textContent = formatPHP(item.price * item.quantity);
                box.appendChild(img);
                box.appendChild(middle);
                box.appendChild(removeBtn);
                box.appendChild(priceEl);
                cartItemsContainer.appendChild(box);
            });
            cartCountEl.textContent = totalQty;
            cartSubtotalEl.textContent = formatPHP(subtotal);
            attachCartEvents();
        }
        function attachCartEvents() {
            document.querySelectorAll('.qty-btn.decrease').forEach(btn => {
                btn.onclick = function(e) {
                    const idx = parseInt(btn.getAttribute('data-index'), 10);
                    if (!isNaN(idx) && cart[idx]) {
                        if (cart[idx].quantity > 1) {
                            cart[idx].quantity--;
                        }
                        renderCart();
                        saveCartToLocalStorage();
                    }
                };
            });
            document.querySelectorAll('.qty-btn.increase').forEach(btn => {
                btn.onclick = function(e) {
                    const idx = parseInt(btn.getAttribute('data-index'), 10);
                    if (!isNaN(idx) && cart[idx]) {
                        cart[idx].quantity++;
                        renderCart();
                        saveCartToLocalStorage();
                    }
                };
            });
            document.querySelectorAll('.cart-item-remove').forEach(btn => {
                btn.onclick = function(e) {
                    const idx = parseInt(btn.getAttribute('data-index'), 10);
                    if (!isNaN(idx)) {
                        cart.splice(idx, 1);
                        renderCart();
                        saveCartToLocalStorage();
                    }
                };
            });
        }
        document.addEventListener('DOMContentLoaded', function() {
            const navCartBtn = getNavCartButton();
            if (navCartBtn) {
                navCartBtn.removeAttribute('onclick');
                navCartBtn.addEventListener('click', function(e){
                    e.preventDefault();
                    openCartSidebar();
                });
            }
            if (closeCartBtn) closeCartBtn.addEventListener('click', closeCartSidebar);
            if (cartOverlay) cartOverlay.addEventListener('click', closeCartSidebar);
            renderCart();
            if (checkoutBtn) {
                checkoutBtn.addEventListener('click', function(){
                    window.location.href = 'checkout.html';
                });
            }
        });
    })();
    </script>
</html>
