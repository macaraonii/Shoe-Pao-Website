<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Products - SHOEPAO</title>
    <link rel="stylesheet" href="style.css">
    <style>
        .productlist-sidebar {
            min-width: 220px;
            max-width: 260px;
            display: flex;
            flex-direction: column;
            gap: 12px;
            /* overflow-y: auto; */
            /* max-height: 340px; */
            padding-right: 8px;
            margin-bottom: 0;
        }
        .sidebar-header {
            font-size: 1.18rem;
            font-weight: 600;
            color: #222;
            margin-bottom: 18px;
        }
        .gender-checkbox-row {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-bottom: 18px;
        }
        .gender-checkbox {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 1.05rem;
            font-weight: 500;
            color: #222;
        }
        .sidebar-divider {
            width: 80%;
            height: 2px;
            background: #eee;
            margin: 18px 0 12px 0;
        }
        .sidebar-size-header {
            font-size: 1.08rem;
            font-weight: 600;
            color: #222;
            margin-bottom: 14px;
        }
        .size-btn-row {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }
        .size-btn {
            background: #fff;
            color: #222;
            border: 2px solid #ccc;
            border-radius: 18px;
            padding: 8px 18px;
            font-size: 1.05rem;
            font-weight: 500;
            cursor: pointer;
            transition: background 0.18s, color 0.18s, border-color 0.18s;
            width: 56px;
            height: 38px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }
        .size-btn.active {
            background: #222;
            color: #fff;
            border-color: #222;
        }
        .size-btn {
            background: #fff;
            color: #222;
            border: 2px solid #ccc;
            border-radius: 18px;
            padding: 8px 18px;
            font-size: 1.05rem;
            font-weight: 500;
            cursor: pointer;
            transition: background 0.2s, color 0.2s, border 0.2s;
        }
        .size-btn.active {
            background: #222;
            color: #fff;
            border-color: #222;
        }
        .productlist-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            gap: 32px;
            min-width: 0;
        }
        .productlist-caption-row {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 32px;
            margin-top: 0;
            width: 100%;
        }
        .productlist-caption {
            font-size: 1.18rem;
            font-weight: 400;
            color: #222;
        }
        .productlist-caption .brand {
            font-weight: 700;
        }
        .productlist-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            grid-template-rows: repeat(2, 1fr);
            gap: 32px;
            width: 100%;
            max-width: 900px;
        }
        .shoe-card {
            background: none;
            border: none;
            width: 260px;
            display: flex;
            flex-direction: column;
            gap: 0;
        }
        .shoe-img-box {
            position: relative;
            width: 260px;
            height: 170px;
            border-radius: 0;
            overflow: hidden;
        }
        /* Hover color preview swatches inside image box */
        .variant-swatches { position:absolute; left:8px; right:8px; bottom:8px; display:none; gap:6px; justify-content:center; z-index:3 }
        .variant-swatch { width:22px; height:22px; border-radius:50%; border:2px solid #ddd; overflow:hidden; box-shadow:0 1px 4px rgba(0,0,0,0.25); cursor:pointer; background:#f8f8f8 }
        .variant-swatch img { width:100%; height:100%; object-fit:cover }
        .shoe-card:hover .variant-swatches { display:flex }
        .shoe-img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        .shoe-img-overlay { position:absolute; inset:0; width:100%; height:100%; object-fit:cover; opacity:0; transition: opacity 0.25s ease; pointer-events:none }
        .shoe-img-base { position:relative; z-index:1 }
        .badge-new {
            position: absolute;
            top: 16px;
            left: 16px;
            background: #222;
            color: #fff;
            font-size: 0.98rem;
            font-weight: 500;
            border-radius: 12px;
            padding: 4px 18px;
            z-index: 2;
        }
        .badge-sale {
            position: absolute;
            top: 16px;
            left: 16px;
            background: #b71c1c;
            color: #fff;
            font-size: 0.98rem;
            font-weight: 500;
            border-radius: 12px;
            padding: 4px 14px;
            z-index: 2;
        }
        .badge-preorder {
            position: absolute;
            top: 16px;
            left: 16px;
            background: #fff7e6;
            color: #b07100;
            font-size: 0.98rem;
            font-weight: 500;
            border-radius: 12px;
            padding: 4px 14px;
            z-index: 2;
            border: 1px solid #ffd18a;
        }
        .badge-bestseller {
            position: absolute;
            top: 16px;
            left: 16px;
            background: #e6f7ea;
            color: #1b5e20;
            font-size: 0.98rem;
            font-weight: 500;
            border-radius: 12px;
            padding: 4px 14px;
            z-index: 2;
            border: 1px solid #a5d6a7;
        }
        .flip-horizontal {
            transform: scaleX(-1);
            transform-origin: center;
        }
        .shoe-info-box {
            background: #f7f7f7;
            border-radius: 0;
            padding: 16px 18px 12px 18px;
            display: flex;
            flex-direction: column;
            gap: 6px;
        }
        .shoe-info-top {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 1.08rem;
            font-weight: 500;
            color: #222;
        }
        .shoe-brand {
            font-weight: 600;
        }
        .shoe-price {
            font-weight: 500;
            color: #222;
        }
        .shoe-price-old {
            text-decoration: line-through;
            color: #888;
            margin-right: 8px;
            font-size: 0.98rem;
        }
    </style>
</head>
<body class="productlist-body" style="min-height:100vh;display:flex;flex-direction:column;">
    <!-- Navigation Bar (copied from home.html) -->
    <nav class="homepage-header" style="position:sticky;top:0;z-index:100;background:#fff;box-shadow:0 2px 8px rgba(0,0,0,0.04);padding:0 40px;display:flex;align-items:center;justify-content:space-between;height:72px;padding-left:46px;">
    <div style="display:flex;align-items:center;gap:24px;">
            <a href="home.html" style="display:flex;align-items:center;gap:30px;text-decoration:none;color:inherit;">
                <img src="IMAGE/SHOEPAOLOGO.png" alt="SHOEPAO Logo" style="height:42px;width:auto;cursor:pointer;">
                <span class="header-caption" style="font-size:1.18rem;font-weight:600;color:#b71c1c;cursor:pointer;">Shoe Pao Footwear</span>
            </a>
            <span class="header-link" onclick="goToSale()">Sale</span>
            <span class="header-link" onclick="goToNewArrivals()">New Arrivals</span>
            <span class="header-link" id="brandNavPL">Brands
                <div class="brand-dropdown" id="brandDropdownPL" aria-hidden="true">
                    <a href="product-list.html?brand=Nike" class="brand-drop-link" onclick="event.preventDefault(); applyBrand('Nike')"><img src="IMAGE/NIKELOGO.png" alt="Nike" style="height:28px;"></a>
                    <a href="product-list.html?brand=Adidas" class="brand-drop-link" onclick="event.preventDefault(); applyBrand('Adidas')"><img src="IMAGE/ADIDASLOGO.png" alt="Adidas" style="height:28px;"></a>
                    <a href="product-list.html?brand=Cloudtilt" class="brand-drop-link" onclick="event.preventDefault(); applyBrand('Cloudtilt')"><img src="IMAGE/CLOUDTILTLOGO.png" alt="Cloudtilt" style="height:28px;"></a>
                    <a href="product-list.html?brand=New%20Balance" class="brand-drop-link" onclick="event.preventDefault(); applyBrand('New Balance')"><img src="IMAGE/NEWBALANCELOGO.png" alt="New Balance" style="height:28px;"></a>
                </div>
            </span>
            <style>
                /* ensure brand dropdown anchors under nav item */
                #brandNavPL { position: relative; }
                /* match home page: horizontal brand icons */
                #brandDropdownPL { display: none; position: absolute; top: 100%; left: 50%; transform: translateX(-50%); background: #fff; color: #222; border: 1px solid #eee; padding: 8px 10px; border-radius: 6px; box-shadow: 0 6px 18px rgba(0,0,0,0.08); z-index: 120; white-space: nowrap; text-align: center; }
                .brand-drop-link { display: inline-block; margin: 4px 8px; }
            </style>
            <span class="header-link" onclick="goToProductList()">Shop All</span>
        </div>
        <div style="display:flex;align-items:center;gap:18px;">
            <button class="header-icon-btn" onclick="toggleSearchBox()" style="background:none;border:none;padding:6px;display:flex;align-items:center;cursor:pointer;"><img src="IMAGE/SEARCHICON.png" class="header-icon" alt="Search" style="width:26px;height:26px;"></button>
            <button class="header-icon-btn" onclick="goToUserPage()" style="background:none;border:none;padding:6px;display:flex;align-items:center;cursor:pointer;"><img src="IMAGE/USERICON.png" class="header-icon" alt="User" style="width:26px;height:26px;"></button>
            <button class="header-icon-btn" id="cartToggleBtn" style="background:none;border:none;padding:6px;display:flex;align-items:center;cursor:pointer;"><img src="IMAGE/CARTICON.png" class="header-icon" alt="Cart" style="width:26px;height:26px;"></button>
        </div>
        <div class="search-box" id="searchBox" style="display:none;position:absolute;top:72px;right:80px;background:#fff;border:1px solid #ccc;border-radius:8px;padding:8px 16px;z-index:101;">
            <input type="text" class="search-input" id="searchInput" placeholder="Search products..." onkeydown="searchKeyDown(event)" style="font-family:'Poppins',Arial,sans-serif;font-size:1rem;border:none;outline:none;width:220px;padding:6px 0;">
        </div>
    </nav>
    <main class="productlist-main-content" style="flex:1 1 auto;padding-top:20px;">
        <div class="site-container">
        <div class="productlist-main">
            <!-- Sidebar -->
            <aside class="productlist-sidebar" style="padding-left:24px;">
                <div class="sidebar-section">
                    <div class="sidebar-header" style="font-size:1.18rem;font-weight:600;color:#222;margin-bottom:18px;">Gender</div>
                    <div class="gender-checkbox-row" style="display:flex;flex-direction:column;gap:10px;margin-bottom:18px;">
                        <label class="gender-checkbox" style="display:flex;align-items:center;gap:8px;font-size:1.05rem;font-weight:500;color:#222;">
                            <input type="checkbox" id="genderMen" checked onchange="applyAllFilters()" style="accent-color:#000;width:18px;height:18px;">
                            <span style="color:#222;">Men</span>
                        </label>
                        <label class="gender-checkbox" style="display:flex;align-items:center;gap:8px;font-size:1.05rem;font-weight:500;color:#222;">
                            <input type="checkbox" id="genderWomen" checked onchange="applyAllFilters()" style="accent-color:#000;width:18px;height:18px;">
                            <span style="color:#222;">Women</span>
                        </label>
                        <label class="gender-checkbox" style="display:flex;align-items:center;gap:8px;font-size:1.05rem;font-weight:500;color:#222;">
                            <input type="checkbox" id="genderUnisex" checked onchange="applyAllFilters()" style="accent-color:#000;width:18px;height:18px;">
                            <span style="color:#222;">Unisex</span>
                        </label>
                    </div>
                    <div style="margin-top:6px;margin-bottom:8px;">
                        <div class="sidebar-header" style="font-size:1.08rem;font-weight:600;color:#222;margin-bottom:8px;">Brands</div>
                        <div style="display:flex;flex-direction:column;gap:8px;margin-bottom:8px;">
                            <label class="gender-checkbox"><input type="checkbox" class="brand-checkbox" id="brandNike" value="Nike" checked onchange="applyAllFilters()" style="accent-color:#000;width:18px;height:18px;margin-right:8px;"> Nike</label>
                            <label class="gender-checkbox"><input type="checkbox" class="brand-checkbox" id="brandAdidas" value="Adidas" checked onchange="applyAllFilters()" style="accent-color:#000;width:18px;height:18px;margin-right:8px;"> Adidas</label>
                            <label class="gender-checkbox"><input type="checkbox" class="brand-checkbox" id="brandCloudtilt" value="Cloudtilt" checked onchange="applyAllFilters()" style="accent-color:#000;width:18px;height:18px;margin-right:8px;"> Cloudtilt</label>
                            <label class="gender-checkbox"><input type="checkbox" class="brand-checkbox" id="brandNewBalance" value="New Balance" checked onchange="applyAllFilters()" style="accent-color:#000;width:18px;height:18px;margin-right:8px;"> New Balance</label>
                        </div>
                    </div>
                    <div class="sidebar-divider" style="width:80%;height:2px;background:#eee;margin:18px 0 12px 0;"></div>
                </div>
                <div class="sidebar-section">
                    <div class="sidebar-size-header" style="font-size:1.08rem;font-weight:600;color:#222;margin-bottom:14px;">Size</div>
                    <div class="size-control" style="display:flex;flex-direction:column;gap:8px;">
                        <div style="display:flex;gap:8px;align-items:center;">
                            <label style="font-weight:600;margin-right:8px;font-size:1rem;color:#222;">Size Standard:</label>
                            <button id="euBtn" class="size-standard-btn" style="padding:6px 12px;border-radius:8px;border:1px solid #222;background:#222;color:#fff;font-weight:600;">EU</button>
                            <button id="usBtn" class="size-standard-btn" style="padding:6px 12px;border-radius:8px;border:1px solid #ccc;background:#fff;color:#222;">US</button>
                        </div>
                        <div class="size-btn-row" id="sizeBtnRow" style="display:flex;flex-wrap:wrap;gap:10px;"></div>
                    </div>
                </div>
            </aside>
            <!-- Main Content -->
            <section class="productlist-content">
                <div class="productlist-caption-row" id="productlist-caption-row" style="margin-bottom:16px;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:8px;">
                    <span id="productlist-caption" class="productlist-caption" style="text-align:center;display:block;min-height:1.2em;"></span>
                    <button id="clearSearchBtn" aria-label="Clear search" style="display:none;background:transparent;border:none;color:#222;cursor:pointer;font-size:0.95rem;display:flex;align-items:center;gap:8px;padding:6px 10px;">
                        <span style="width:18px;height:18px;display:inline-flex;align-items:center;justify-content:center;">âœ•</span>
                        <span>Clear search</span>
                    </button>
                </div>
                <div class="productlist-grid" id="productGrid">
                    <div class="shoe-card" data-gender="Men" data-size="8" style="cursor:pointer;" onclick="viewProduct('Nike','Nike Airmax TN Aqua Blue','P1,299.00','IMAGE/NIKE1.png','New')">
                        <div class="shoe-img-box">
                            <img src="IMAGE/NIKE1.png" class="shoe-img flip-horizontal" alt="Nike Airmax TN Aqua Blue">
                            <span class="badge-new">New</span>
                        </div>
                        <div class="shoe-info-box">
                            <div class="shoe-info-top">
                                <span class="shoe-brand">Nike</span>
                                <span class="shoe-price">P1,299.00</span>
                            </div>
                            <div class="shoe-info-bottom">Nike Airmax TN Aqua Blue</div>
                        </div>
                    </div>
                    <div class="shoe-card" data-gender="Men" data-size="9" style="cursor:pointer;" onclick="viewProduct('Nike','Nike Airmax Black','P2,395.00','IMAGE/NIKE2.png','New')">
                        <div class="shoe-img-box">
                            <img src="IMAGE/NIKE2.png" class="shoe-img flip-horizontal" alt="Nike Airmax Black">
                            <span class="badge-new">New</span>
                        </div>
                        <div class="shoe-info-box">
                            <div class="shoe-info-top">
                                <span class="shoe-brand">Nike</span>
                                <span class="shoe-price">P2,395.00</span>
                            </div>
                            <div class="shoe-info-bottom">Nike Airmax Black</div>
                        </div>
                    </div>
                    <div class="shoe-card" data-gender="Women" data-size="7" style="cursor:pointer;" onclick="viewProduct('Nike','Nike GT CUT 2 LEAP HIGH','P1,999.00','IMAGE/NIKE3.png','New')">
                        <div class="shoe-img-box">
                            <img src="IMAGE/NIKE3.png" class="shoe-img flip-horizontal" alt="Nike GT CUT 2 LEAP HIGH">
                        </div>
                        <div class="shoe-info-box">
                            <div class="shoe-info-top">
                                <span class="shoe-brand">Nike</span>
                                <span class="shoe-price-old">P2,395.00</span><span class="shoe-price">P1,999.00</span>
                            </div>
                            <div class="shoe-info-bottom">Nike GT CUT 2 LEAP HIGH</div>
                        </div>
                    </div>
                    <div class="shoe-card" data-gender="Women" data-size="8" style="cursor:pointer;" onclick="viewProduct('Nike','Nike Airmax White','P2,199.00','IMAGE/NIKE4.png','New')">
                        <div class="shoe-img-box">
                            <img src="IMAGE/NIKE4.png" class="shoe-img flip-horizontal" alt="Nike Airmax White">
                        </div>
                        <div class="shoe-info-box">
                            <div class="shoe-info-top">
                                <span class="shoe-brand">Nike</span>
                                <span class="shoe-price">P2,199.00</span>
                            </div>
                            <div class="shoe-info-bottom">Nike Airmax White</div>
                        </div>
                    </div>
                    <div class="shoe-card" data-gender="Men" data-size="10" style="cursor:pointer;" onclick="viewProduct('Nike','Nike Airmax Red','P2,299.00','IMAGE/NIKE5.png','New')">
                        <div class="shoe-img-box">
                            <img src="IMAGE/NIKE5.png" class="shoe-img flip-horizontal" alt="Nike Airmax Red">
                        </div>
                        <div class="shoe-info-box">
                            <div class="shoe-info-top">
                                <span class="shoe-brand">Nike</span>
                                <span class="shoe-price">P2,299.00</span>
                            </div>
                            <div class="shoe-info-bottom">Nike Airmax Red</div>
                        </div>
                    </div>
                    <!-- Sale items added from Home -> Sale -->
                    <div class="shoe-card" data-gender="Women" data-size="8" style="cursor:pointer;" onclick="viewProduct('Cloudtilt','Cloudtilt Iron Dew Womens','P1,299.00','IMAGE/SALESSHOE1.png','Sale')">
                        <div class="shoe-img-box">
                            <img src="IMAGE/SALESSHOE1.png" class="shoe-img" alt="Cloudtilt Iron Dew Womens">
                            <span class="badge-sale">Sale</span>
                        </div>
                        <div class="shoe-info-box">
                            <div class="shoe-info-top">
                                <span class="shoe-brand">Cloudtilt</span>
                                <span><span class="shoe-price-old">P2,295.00</span><span class="shoe-price">P1,299.00</span></span>
                            </div>
                            <div class="shoe-info-bottom">Cloudtilt Iron Dew Womens</div>
                        </div>
                    </div>
                    <div class="shoe-card" data-gender="Men" data-size="9" style="cursor:pointer;" onclick="viewProduct('New Balance','New Balance 530','P1,299.00','IMAGE/SALESSHOE2.png','Sale')">
                        <div class="shoe-img-box">
                            <img src="IMAGE/SALESSHOE2.png" class="shoe-img" alt="New Balance 530">
                            <span class="badge-sale">Sale</span>
                        </div>
                        <div class="shoe-info-box">
                            <div class="shoe-info-top">
                                <span class="shoe-brand">New Balance</span>
                                <span><span class="shoe-price-old">P2,295.00</span><span class="shoe-price">P1,299.00</span></span>
                            </div>
                            <div class="shoe-info-bottom">New Balance 530</div>
                        </div>
                    </div>
                </div>
            </section>
        </div>
        </div>
    </main>
    
    <script>
    // Header nav helpers (product-list)
    function goToSale(){ window.location.href = 'product-list.html?filter=sale'; }
    function goToNewArrivals(){ window.location.href = 'product-list.html?filter=new'; }
    // Brand dropdown toggle for product-list header
    document.addEventListener('DOMContentLoaded', function(){
        var brandNav = document.getElementById('brandNavPL');
        var brandDropdown = document.getElementById('brandDropdownPL');
        if(!brandNav || !brandDropdown) return;
        brandNav.addEventListener('click', function(e){
            e.stopPropagation();
            var showing = brandDropdown.style.display === 'block';
            brandDropdown.style.display = showing ? 'none' : 'block';
        });
        document.addEventListener('click', function(){ brandDropdown.style.display = 'none'; });

        // Read URL params and pre-filter cards if needed
    var params = new URLSearchParams(window.location.search);
    var qBrand = params.get('brand');
    var qFilter = params.get('filter');

    function applyUrlFilters(){
            // hide the large Brands section when a specific filter/brand is active
            var brandsSection = document.getElementById('brands');
            if(brandsSection && (qBrand || qFilter)) brandsSection.style.display = 'none';

            // apply card filtering
            var cards = Array.from(document.querySelectorAll('.shoe-card'));
            var visibleCount = 0;
            cards.forEach(function(card){
                var keep = true;
                if(qBrand){
                    var b = (card.getAttribute('data-brand')||'').toLowerCase();
                    if(b !== qBrand.toLowerCase()) keep = false;
                }
                if(qFilter === 'sale'){
                    var badge = card.querySelector('.badge-sale');
                    if(!badge) keep = false;
                }
                if(qFilter === 'new'){
                    var badge = card.querySelector('.badge-new');
                    if(!badge) keep = false;
                }
                card.style.display = keep ? '' : 'none';
                if(keep) visibleCount++;
            });

            // show no-results message if nothing matched
            var content = document.querySelector('.productlist-content');
            if(!content) return;
            var existing = document.querySelector('.no-results-message');
            if(existing) existing.remove();
            if(visibleCount === 0){
                var msg = 'No matching products';
                if(qFilter === 'sale') msg = 'No shoes on Sale';
                else if(qFilter === 'new') msg = 'No New Arrivals';
                else if(qBrand) msg = 'No ' + qBrand + ' shoes';
                var el = document.createElement('div');
                el.className = 'no-results-message';
                el.style.padding = '28px';
                el.style.color = '#666';
                el.style.fontSize = '1.05rem';
                el.textContent = msg;
                content.insertBefore(el, content.firstChild);
            }
        }

        function runInitialFilters(){
            // prefer brand-specific filtering if a brand param is present
            if(qBrand){
                // run after a brief delay to ensure cards rendered
                setTimeout(function(){ try{ applyBrand(qBrand); }catch(e){ applyUrlFilters(); } }, 150);
                return;
            }
            if(qFilter){
                setTimeout(applyUrlFilters, 150);
            }
        }

        // run initial filters when page loads
        runInitialFilters();
    });
    </script>
    <script>
    function viewProduct(brand, name, price, img, badge) {
        localStorage.setItem('productBrand', brand);
        localStorage.setItem('productTitle', name);
        localStorage.setItem('productPrice', price);
        localStorage.setItem('productImg', img);
        localStorage.setItem('productBadge', badge);
        window.location.href = 'product-view.html';
    }
    // Add to Cart button logic
    document.addEventListener('DOMContentLoaded', function() {
    });
    // Navigation bar functions (copied from home.html)
    function goToHomeTop() { window.location.href = 'home.html#top'; }
    function goToSale() { window.location.href = 'product-list.html?filter=sale'; }
    function goToNewArrivals() { window.location.href = 'product-list.html?filter=new'; }
    function goToBrands() { window.location.href = 'product-list.html'; }
    function goToProductList() { window.location.href = 'product-list.html'; }
    function goToUserPage() {
    try{ var p = JSON.parse(sessionStorage.getItem('profile')||localStorage.getItem('profile')||'null'); if(!p || !p.email){ window.location.href = 'login.html'; return; } }catch(e){ window.location.href = 'login.html'; return; }
        window.location.href = 'profile.html';
    }
    function goToCartPage() { window.location.href = 'cart.html'; }
    function toggleSearchBox() {
        var box = document.getElementById('searchBox');
        box.style.display = (box.style.display === 'block') ? 'none' : 'block';
        if (box.style.display === 'block') {
            document.getElementById('searchInput').focus();
        }
    }
    function searchKeyDown(e) {
        if (e.key === 'Enter') {
            var val = document.getElementById('searchInput').value.trim();
            if (val) {
                window.location.href = 'product-list.html?search=' + encodeURIComponent(val);
            }
        }
    }
    // Gender filter: delegate to unified filter so all controls combine correctly
    function filterGender() {
        applyAllFilters();
    }

    // Apply a brand filter from the header dropdown or elsewhere.
    // This will check the corresponding brand checkbox, uncheck others, and run the unified filter.
    function applyBrand(brand){
        try{
            if(!brand) return;
            var boxes = Array.from(document.querySelectorAll('.brand-checkbox'));
            var found = false;
            boxes.forEach(function(b){
                if(!b) return;
                if(String(b.value || '').toLowerCase() === String(brand||'').toLowerCase()){ b.checked = true; found = true; }
                else b.checked = false;
            });
            // if no brand checkboxes exist (or none matched), just perform a search-like filter
            if(!found){
                // mark search box and clear other filters
                try{ var si = document.getElementById('searchInput'); if(si) si.value = '';}catch(e){}
            }
            // hide dropdown if present
            try{ var dd = document.getElementById('brandDropdownPL'); if(dd) dd.style.display = 'none'; }catch(e){}
            // apply unified filters to update visible cards
            if(typeof applyAllFilters === 'function') applyAllFilters();
            // update URL param for shareability (without reload)
            try{
                var url = new URL(window.location.href);
                url.searchParams.set('brand', brand);
                window.history.replaceState({}, '', url.pathname + url.search + url.hash);
            }catch(e){}
        }catch(e){ console.error('applyBrand failed', e); }
    }
    // Size filter + EU/US toggle with persistent selected sizes (stored as EU internally)
    (function(){
        const EU_SIZES = ['36','37','38','39','40','41','42','43','44','45'];
        const US_SIZES = ['5','5.5','6.5','7','7.5','8','8.5','9.5','10','11'];
        const US_TO_EU = { '5':'36','5.5':'37','6.5':'38','7':'39','7.5':'40','8':'41','8.5':'42','9.5':'43','10':'44','11':'45' };
        const EU_TO_US = Object.fromEntries(Object.entries(US_TO_EU).map(([u,e])=>[e,u]));

        function getStandard(){ return localStorage.getItem('sizeStandard') || 'EU'; }
        function setStandard(v){ localStorage.setItem('sizeStandard', v); }

        // selected sizes are stored as an array of EU sizes in localStorage.selectedEU
        function getSelectedEU(){ try{ return JSON.parse(localStorage.getItem('selectedEU') || '[]'); }catch(e){ return []; } }
        function setSelectedEU(arr){ localStorage.setItem('selectedEU', JSON.stringify(Array.from(new Set(arr)))); }
        function toggleSelectedEU(eu){ const cur = new Set(getSelectedEU()); if(cur.has(eu)) cur.delete(eu); else cur.add(eu); setSelectedEU([...cur]); }

        const euBtn = document.getElementById('euBtn');
        const usBtn = document.getElementById('usBtn');
        const sizeBtnRow = document.getElementById('sizeBtnRow');

        function clearSizeButtons(){ sizeBtnRow.innerHTML = ''; }

        function renderSizeButtons(){
            clearSizeButtons();
            const std = getStandard();
            const sizes = (std === 'EU') ? EU_SIZES : US_SIZES;
            const selectedEU = new Set(getSelectedEU());
            sizes.forEach(sz => {
                const b = document.createElement('button');
                b.className = 'size-btn';
                b.textContent = sz;
                b.dataset.size = sz;
                // determine the EU equivalent for this button
                const eu = (std === 'EU') ? sz : (US_TO_EU[sz] || null);
                if(eu && selectedEU.has(eu)) b.classList.add('active');
                b.addEventListener('click', function(){
                    if(!eu) return;
                    toggleSelectedEU(eu);
                    // re-render to keep visual state consistent across standards
                    renderSizeButtons();
                    applyAllFilters();
                });
                sizeBtnRow.appendChild(b);
            });
            // style standard buttons
            if(getStandard() === 'EU'){
                euBtn.style.background = '#222'; euBtn.style.color = '#fff'; euBtn.style.borderColor = '#222';
                usBtn.style.background = '#fff'; usBtn.style.color = '#222'; usBtn.style.borderColor = '#ccc';
            } else {
                usBtn.style.background = '#222'; usBtn.style.color = '#fff'; usBtn.style.borderColor = '#222';
                euBtn.style.background = '#fff'; euBtn.style.color = '#222'; euBtn.style.borderColor = '#ccc';
            }
        }

        euBtn.addEventListener('click', function(){ setStandard('EU'); renderSizeButtons(); applyAllFilters(); });
        usBtn.addEventListener('click', function(){ setStandard('US'); renderSizeButtons(); applyAllFilters(); });

        function getCardProductInfo(card){
            let brand = card.getAttribute('data-brand') || '';
            let title = card.getAttribute('data-title') || '';
            if(!brand || !title){
                const onclick = card.getAttribute('onclick') || '';
                const m = onclick.match(/viewProduct\(\s*'([^']*)'\s*,\s*'([^']*)'/);
                if(m){ brand = brand || m[1]; title = title || m[2]; }
            }
            return { brand: (brand||'').trim(), title: (title||'').trim() };
        }

        // ===== Build inventory solely from admin-managed products =====
        // Remove legacy seeded products and regenerate inventory from shoeInventoryData.
        try{
            var adminProducts = JSON.parse(localStorage.getItem('shoeInventoryData')||'null');
            var newInv = [];
            if(Array.isArray(adminProducts) && adminProducts.length){
                adminProducts.forEach(function(p){
                    var baseImg = (Array.isArray(p.images) && p.images.length) ? p.images[0] : '';
                    (Array.isArray(p.colors) ? p.colors : []).forEach(function(c){
                        var sizesMap = {};
                        (Array.isArray(c.sizes) ? c.sizes : []).forEach(function(s){ sizesMap[String(s.eu)] = Number(s.stock||0); });
                        newInv.push({
                            id: p.sku || p.id || ('gen-' + Math.random().toString(36).slice(2,9)),
                            name: (p.model||'') + (c.name?(' '+c.name):''),
                            brand: p.brand || '',
                            color: c.name || '',
                            image: baseImg || 'IMAGE/NIKE1.png',
                            sizes: sizesMap,
                            price: Number((p.pricing && (p.pricing.sale||p.pricing.original)) || 0),
                            originalPrice: Number((p.pricing && p.pricing.original) || 0),
                            productId: p.id || '',
                            colorId: c.id || '',
                            createdAt: p.createdAt || null,
                            gender: p.gender || ''
                        });
                    });
                });
            }
            localStorage.setItem('inventory', JSON.stringify(newInv));
        }catch(e){}


        function findInventoryForProduct(product){
            try{
                const inv = JSON.parse(localStorage.getItem('inventory') || '[]');
                if(!Array.isArray(inv)) return null;
                const title = (product.title||'').trim();
                const brand = (product.brand||'').trim();
                let found = inv.find(i => (i.name||'').toString().trim() === title);
                if(!found) found = inv.find(i => title && (i.name||'').toString().toLowerCase().indexOf(title.toLowerCase()) !== -1);
                if(!found && brand) found = inv.find(i => (i.brand||'').toString().toLowerCase() === brand.toLowerCase());
                return found || null;
            }catch(e){ return null; }
        }

        // Helper to derive a base model name by stripping trailing color from item.name
        function getBaseModelName(item){
            try{
                var name = (item && item.name) ? String(item.name) : '';
                var color = (item && item.color) ? String(item.color) : '';
                if(!name) return '';
                if(color){
                    var esc = color.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
                    var re = new RegExp('\\s*' + esc + '\\s*$', 'i');
                    name = name.replace(re, '').trim();
                }
                return name.trim();
            }catch(e){ return (item && item.name) ? String(item.name) : ''; }
        }

        // Render inventory items as grouped models (one card per model with color variants)
        function renderInventoryCards(){
            try{
                var grid = document.getElementById('productGrid');
                if(!grid) return;
                var inv = JSON.parse(localStorage.getItem('inventory') || '[]');
                if(!Array.isArray(inv)) return;

                // Group by brand + base model name
                var groups = {};
                inv.forEach(function(item){
                    if(!item) return;
                    var brand = (item.brand||'').toString().trim();
                    var base = getBaseModelName(item);
                    var key = (brand + '|||'+ base).toLowerCase();
                    if(!groups[key]){
                        groups[key] = { brand: brand, baseName: base, variants: [] };
                    }
                    groups[key].variants.push(item);
                });

                // Clear existing static cards and rebuild grid from groups
                grid.innerHTML = '';

                // Precompute best sellers from admin sales log (by productId)
                var bestSet = (function(){
                    try{
                        var sales = JSON.parse(localStorage.getItem('shoeSalesLog')||'[]');
                        var byPid = {};
                        sales.forEach(function(s){ var pid = s.productId; var q = Number(s.qty||0); if(pid){ byPid[pid] = (byPid[pid]||0) + q; } });
                        return new Set(Object.entries(byPid).sort(function(a,b){ return b[1]-a[1]; }).slice(0,5).map(function(e){ return e[0]; }));
                    }catch(e){ return new Set(); }
                })();

                Object.keys(groups).forEach(function(key){
                    var g = groups[key];
                    if(!g || !g.variants || g.variants.length === 0) return;
                    // choose primary variant (first with image)
                    var primary = g.variants.find(function(v){ return v && v.image; }) || g.variants[0];
                    var imgSrc = (primary && primary.image) ? primary.image : 'IMAGE/NIKE1.png';

                    // price: show single if same across variants, else From min
                    var prices = g.variants.map(function(v){ return Number(v.price||0); });
                    var minP = Math.min.apply(null, prices);
                    var maxP = Math.max.apply(null, prices);
                    var priceText = (minP === maxP) ? ('P' + Number(minP).toLocaleString(undefined,{minimumFractionDigits:2}))
                                                    : ('From P' + Number(minP).toLocaleString(undefined,{minimumFractionDigits:2}));

                    // gender: if all same use it, else Unisex
                    var genders = Array.from(new Set(g.variants.map(function(v){ return (v.gender||'').toString(); }).filter(Boolean)));
                    var genderAttr = (genders.length === 1) ? genders[0] : 'Unisex';

                    // Compute group-level tags
                    var nowMs = Date.now();
                    var isSale = g.variants.some(function(v){ return Number(v.originalPrice||0) > 0 && Number(v.price||0) < Number(v.originalPrice||0); });
                    var isNew = g.variants.some(function(v){ if(!v.createdAt) return false; var t = new Date(v.createdAt).getTime(); return (nowMs - t) <= (14*24*3600*1000); });
                    var totalStock = g.variants.reduce(function(acc, v){ try{ var sm=v.sizes||{}; return acc + Object.values(sm).reduce(function(a,b){ return a + (Number(b)||0); },0); }catch(_){ return acc; } }, 0);
                    var isPreOrder = totalStock === 0;
                    var anyProductId = (primary && primary.productId) || '';
                    var isBest = anyProductId && bestSet.has(anyProductId);

                    var card = document.createElement('div');
                    card.className = 'shoe-card';
                    card.style.cursor = 'pointer';
                    card.setAttribute('data-brand', g.brand || '');
                    card.setAttribute('data-title', g.baseName || '');
                    card.setAttribute('data-base-name', g.baseName || '');
                    if(genderAttr) card.setAttribute('data-gender', genderAttr);

                    var flipClass = (g.brand && g.brand.toString().toLowerCase().indexOf('nike')!==-1) ? ' flip-horizontal' : '';
                    // Build swatches markup (limit to 8)
                    var swHTML = '';
                    g.variants.slice(0,8).forEach(function(v){ var src = v.image || imgSrc; swHTML += '<button type="button" class="variant-swatch" title="'+(v.color||g.baseName||'Color')+'"><img src="'+src+'" alt="'+(v.color||'color')+'"></button>'; });
                    var inner = '' +
                        '<div class="shoe-img-box">' +
                        '  <img src="'+imgSrc+'" class="shoe-img shoe-img-base'+flipClass+'" alt="'+(g.baseName||'Product')+'">' +
                        '  <img src="'+imgSrc+'" class="shoe-img shoe-img-overlay'+flipClass+'" alt="'+(g.baseName||'Product')+' preview" aria-hidden="true">' +
                        (isSale ? '<span class="badge-sale">Sale</span>' : (isNew ? '<span class="badge-new">New</span>' : (isBest ? '<span class="badge-bestseller">Best Seller</span>' : (isPreOrder ? '<span class="badge-preorder">Pre-Order</span>' : '')))) +
                        '  <div class="variant-swatches">'+ swHTML +'</div>' +
                        '</div>' +
                        '<div class="shoe-info-box">' +
                        '  <div class="shoe-info-top">' +
                        '    <span class="shoe-brand">'+(g.brand||'')+'</span>' +
                        '    <span class="shoe-price">'+priceText+'</span>' +
                        '  </div>' +
                        '  <div class="shoe-info-bottom">'+(g.baseName||'')+' ('+g.variants.length+' colors)</div>' +
                        '</div>';
                    card.innerHTML = inner;

                    // Click -> store grouped model in localStorage and go to product view
                    card.addEventListener('click', function(){
                        try{
                            var modelData = {
                                brand: g.brand || '',
                                baseName: g.baseName || '',
                                variants: g.variants.map(function(v){
                                    return {
                                        id: v.id || '',
                                        name: v.name || '',
                                        color: v.color || '',
                                        image: v.image || '',
                                        price: Number(v.price||0),
                                        sizes: v.sizes || {},
                                        gender: v.gender || ''
                                    };
                                })
                            };
                            localStorage.setItem('modelData', JSON.stringify(modelData));
                            // default select first variant for legacy keys
                            var sel = modelData.variants[0] || {};
                            localStorage.setItem('productBrand', modelData.brand);
                            localStorage.setItem('productTitle', sel.name || (modelData.baseName + (sel.color?(' '+sel.color):'')));
                            localStorage.setItem('productPrice', 'P' + Number(sel.price||0).toLocaleString(undefined,{minimumFractionDigits:2}));
                            localStorage.setItem('productImg', sel.image || '');
                            localStorage.setItem('productBadge', '');
                        }catch(e){}
                        window.location.href = 'product-view.html';
                    });

                    // Swatch hover previews: change image on swatch hover and reset on mouseleave
                    try{
                        var baseImg = card.querySelector('.shoe-img-base');
                        var overlayImg = card.querySelector('.shoe-img-overlay');
                        var primarySrc = imgSrc;
                        var variantSrcs = g.variants.map(function(v){ return v && v.image ? v.image : primarySrc; }).filter(Boolean);
                        // remove duplicate sequential srcs
                        variantSrcs = variantSrcs.filter(function(src, i, a){ return i===0 || src !== a[i-1]; });

                        function crossfadeTo(src){
                            if(!baseImg || !overlayImg) return;
                            try{
                                overlayImg.style.transition = 'none';
                                overlayImg.style.opacity = '0';
                                overlayImg.src = src;
                                overlayImg.onload = function(){
                                    overlayImg.onload = null;
                                    requestAnimationFrame(function(){ overlayImg.style.transition = 'opacity 0.25s ease'; overlayImg.style.opacity = '1'; });
                                    setTimeout(function(){ baseImg.src = src; overlayImg.style.opacity = '0'; }, 280);
                                };
                            }catch(_){ baseImg.src = src; }
                        }

                        // Manual swatch preview pauses shuffle
                        card.querySelectorAll('.variant-swatch img').forEach(function(s){
                            s.addEventListener('mouseenter', function(){
                                stopShuffle(true);
                                crossfadeTo(s.getAttribute('src'));
                            });
                            s.parentElement.addEventListener('mouseleave', function(){
                                // resume only if still hovering the card and not over another swatch
                                if(card.matches(':hover')) startShuffle();
                            });
                        });

                        var shuffleIndex = 0;
                        function startShuffle(){
                            if(card._shuffleTimer) return;
                            if(!variantSrcs || variantSrcs.length <= 1) return;
                            // start from current image index if present
                            var currentSrc = baseImg ? baseImg.src : primarySrc;
                            // normalize to relative path end for matching
                            try{ var parts = currentSrc.split('/'); currentSrc = parts[parts.length-1]; }catch(_){ }
                            var idx = variantSrcs.findIndex(function(s){ try{ var p=s.split('/'); return (p[p.length-1]===currentSrc); }catch(_){ return s===currentSrc; } });
                            shuffleIndex = Math.max(0, idx);
                            card._shuffleTimer = setInterval(function(){
                                shuffleIndex = (shuffleIndex + 1) % variantSrcs.length;
                                crossfadeTo(variantSrcs[shuffleIndex]);
                            }, 1000); // shuffle every 1s
                        }
                        function stopShuffle(keepCurrent){ if(card._shuffleTimer){ clearInterval(card._shuffleTimer); card._shuffleTimer = null; } if(!keepCurrent){ crossfadeTo(primarySrc); } }

                        card.addEventListener('mouseenter', startShuffle);
                        var imgBox = card.querySelector('.shoe-img-box');
                        if(imgBox){ imgBox.addEventListener('mouseenter', startShuffle); imgBox.addEventListener('mouseleave', function(){ stopShuffle(false); }); }
                        card.addEventListener('mouseleave', function(){ stopShuffle(false); });
                    }catch(_){ }

                    grid.appendChild(card);
                });
            }catch(e){ console.error('renderInventoryCards error', e); }
        }

        function getQueryParam(name){
            try{
                const params = new URLSearchParams(window.location.search);
                return params.get(name) || '';
            }catch(e){ return ''; }
        }

        function applyAllFilters(){
                const men = document.getElementById('genderMen') ? document.getElementById('genderMen').checked : true;
                const women = document.getElementById('genderWomen') ? document.getElementById('genderWomen').checked : true;
                const unisex = document.getElementById('genderUnisex') ? document.getElementById('genderUnisex').checked : true;
                const selectedEU = getSelectedEU();

                // gather selected brands (by value) - if none selected, show all brands
                const selectedBrands = Array.from(document.querySelectorAll('.brand-checkbox:checked')).map(b=>b.value.toString().toLowerCase());

                const cards = Array.from(document.querySelectorAll('.shoe-card'));
                let visibleCount = 0;
                const rawSearch = (document.getElementById('searchInput') ? document.getElementById('searchInput').value.trim() : '') || getQueryParam('search') || '';
                const searchTerm = rawSearch.toString().toLowerCase();

                cards.forEach(card => {
                    const gender = (card.getAttribute('data-gender') || '').toString();

                    // gender filtering: if no gender checkboxes are checked, treat as 'show all'
                    const anyGenderChecked = men || women || unisex;
                    let genderPass = true;
                    if(anyGenderChecked){
                        genderPass = ((men && gender === 'Men') || (women && gender === 'Women') || (unisex && gender === 'Unisex'));
                    }
                    if(!genderPass){ card.style.display = 'none'; return; }

                    // brand filtering
                    const prod = getCardProductInfo(card);
                    const brandName = (prod.brand || '').toString().toLowerCase();
                    if(selectedBrands.length > 0 && brandName){
                        if(selectedBrands.indexOf(brandName) === -1){ card.style.display = 'none'; return; }
                    }

                    // search filtering (match title or brand)
                    if(searchTerm){
                        const titleText = (prod.title || '').toString().toLowerCase();
                        // also check visible card text as fallback
                        const cardText = (card.textContent || '').toString().toLowerCase();
                        if(!(titleText.includes(searchTerm) || brandName.includes(searchTerm) || cardText.includes(searchTerm))){
                            card.style.display = 'none'; return;
                        }
                    }

                    // size filtering
                    if(selectedEU.length === 0){ card.style.display = ''; visibleCount++; return; }

                    // Size filtering: for grouped cards, aggregate sizes across variants (brand+base-name)
                    let sizeMatch = false;
                    try{
                        const baseName = card.getAttribute('data-base-name') || '';
                        const brandForCard = (prod.brand || '').toString();
                        if(baseName){
                            const inv = JSON.parse(localStorage.getItem('inventory') || '[]');
                            const matches = Array.isArray(inv) ? inv.filter(function(i){
                                if(!i) return false;
                                const b = (i.brand||'').toString().toLowerCase();
                                const thisB = brandForCard.toLowerCase();
                                const thisBase = baseName.toLowerCase();
                                const iBase = (function(){
                                    try{
                                        var nm = (i.name||'').toString();
                                        var col = (i.color||'')+'';
                                        if(col){
                                            var esc = col.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
                                            var re = new RegExp('\\s*' + esc + '\\s*$', 'i');
                                            nm = nm.replace(re, '').trim();
                                        }
                                        return nm.toLowerCase();
                                    }catch(_){ return (i.name||'').toString().toLowerCase(); }
                                })();
                                return b === thisB && iBase === thisBase;
                            }) : [];
                            // union of sizes: if any variant has qty>0 for a selected EU size, it's a match
                            selectedEU.forEach(function(eu){
                                if(sizeMatch) return;
                                for(var k=0;k<matches.length;k++){
                                    var row = matches[k];
                                    var q = (row && row.sizes && (row.sizes[eu] !== undefined)) ? Number(row.sizes[eu]) : null;
                                    if(q !== null && q > 0){ sizeMatch = true; break; }
                                }
                            });
                        } else {
                            // Fallback: single-row match
                            const invRow = findInventoryForProduct(prod);
                            if(!invRow){ sizeMatch = true; }
                            else {
                                for(const eu of selectedEU){
                                    const qty = (invRow.sizes && (invRow.sizes[eu] !== undefined)) ? Number(invRow.sizes[eu]) : null;
                                    if(q !== null && q > 0){ sizeMatch = true; break; }
                                }
                            }
                        }
                    }catch(e){ sizeMatch = true; }

                    card.style.display = sizeMatch ? '' : 'none';
                    if(sizeMatch) visibleCount++;
                });

                // update caption based on search
                try{
                    const capEl = document.getElementById('productlist-caption');
                    const clearBtn = document.getElementById('clearSearchBtn');
                    if(capEl){
                        if(rawSearch){
                            if(visibleCount > 0) capEl.textContent = `Showing ${visibleCount} product${visibleCount>1? 's':''} for "${rawSearch}"`;
                            else capEl.textContent = `No results found for "${rawSearch}"`;
                            if(clearBtn) clearBtn.style.display = 'block';
                        } else {
                            capEl.textContent = '';
                            if(clearBtn) clearBtn.style.display = 'none';
                        }
                    }
                }catch(e){ /* ignore caption errors */ }
        }

        window.addEventListener('storage', function(e){
            if(e.key === 'inventory' || e.key === 'sizeStandard' || e.key === 'selectedEU'){
                try{ if(e.key === 'inventory') renderInventoryCards(); }catch(_){}
                renderSizeButtons();
                applyAllFilters();
            }
        });

        document.addEventListener('DOMContentLoaded', function(){
            if(!localStorage.getItem('sizeStandard')) localStorage.setItem('sizeStandard','EU');
            if(!localStorage.getItem('selectedEU')) localStorage.setItem('selectedEU', JSON.stringify([]));
            renderSizeButtons();
            // render any admin-posted inventory cards
            try{ renderInventoryCards(); }catch(_){}
            // if a search param exists in URL, populate the nav search input so users can cancel/see it
            try{
                const raw = getQueryParam('search');
                const si = document.getElementById('searchInput');
                if(raw && si) si.value = raw;
            }catch(e){}
            applyAllFilters();
            // wire clear button
            try{
                const clearBtn = document.getElementById('clearSearchBtn');
                if(clearBtn){
                    clearBtn.addEventListener('click', function(){
                        const si = document.getElementById('searchInput');
                        if(si) si.value = '';
                        // remove search param from URL without reload
                        try{
                            const url = new URL(window.location.href);
                            url.searchParams.delete('search');
                            window.history.replaceState({}, '', url.pathname + url.search + url.hash);
                        }catch(e){}
                        applyAllFilters();
                        // hide caption/clear button
                        const cap = document.getElementById('productlist-caption');
                        if(cap) cap.textContent = '';
                        clearBtn.style.display = 'none';
                    });
                }
            }catch(e){}
            window.applyAllFilters = applyAllFilters;
        });
    })();
    // Initial filter: show all (use unified filter)
    window.addEventListener('DOMContentLoaded', function() {
        if (typeof applyAllFilters === 'function') applyAllFilters();
    });
    // When page regains focus (user navigates back here), refresh inventory cards and filters
    window.addEventListener('focus', function(){ try{ renderInventoryCards(); renderSizeButtons(); if(typeof applyAllFilters==='function') applyAllFilters(); }catch(e){} });
    document.addEventListener('visibilitychange', function(){ if(document.visibilityState==='visible'){ try{ renderInventoryCards(); renderSizeButtons(); if(typeof applyAllFilters==='function') applyAllFilters(); }catch(e){} } });
    </script>



        <footer class="footer-section">
            <div class="site-container">
                <div class="footer-row">
                    <div class="footer-left">
                        <div class="footer-header">Have questions?</div>
                        <div class="footer-subheader">Contact us at our facebook page</div>
                        <div class="footer-subheader" style="margin-top:18px;">Or via phone/email</div>
                        <div class="footer-divider"></div>
                        <div class="footer-note">All product names, logos, brands, trademarks, and registered trademarks are the property of their respective owners. All company, product, and service names used on this website are for identification purposes only. Use of these names, logos, and brands does not imply endorsement or affiliation.<br><br>Â© 2025 Shoe Pao Footwear. All rights reserved.</div>
                    </div>
                    <div class="footer-right">
                        <a href="about-us.html" class="footer-link">About Us</a>
                        <a href="shipping.html" class="footer-link">Shipping</a>
                        <a href="returns.html" class="footer-link">Returns & Exchanges</a>
                        <a href="privacy.html" class="footer-link">Privacy Policy</a>
                        <a href="terms.html" class="footer-link">Terms of Service</a>
                    </div>
                </div>
            </div>
        </footer>

    <!-- ===== ADDED: Cart Overlay + Sidebar HTML (from product-view.html) ===== -->
    <div id="cartOverlay" class="cart-overlay" aria-hidden="true"></div>
    <aside id="cartSidebar" class="cart-sidebar" aria-hidden="true" role="complementary">
        <div class="cart-header-row">
            <div>
                <span class="cart-header-title">Cart (<span id="cartCount">0</span>)</span>
            </div>
            <button id="closeCartBtn" class="cart-close" aria-label="Close cart"><img src="IMAGE/X.png" alt="Close" style="width:20px;height:20px;"></button>
        </div>
        <div class="cart-divider"></div>
        <div id="cartItems" class="cart-items">
            <div class="cart-empty">Your cart is empty</div>
        </div>
        <div class="cart-divider"></div>
        <div class="cart-subtotal-row">
            <span class="cart-subtotal-label">Subtotal</span>
            <span id="cartSubtotal" class="cart-subtotal-value">â‚±0.00</span>
        </div>
        <button id="checkoutBtn" class="cart-checkout-btn">Checkout</button>
    </aside>
    <!-- ===== ADDED: Cart Sidebar Behavior (from product-view.html) ===== -->
    <script>
    (function(){
        // cart data structure
    let cart = JSON.parse(localStorage.getItem('cart') || '[]');
        // helpers
        function parsePriceToNumber(priceText) {
            if (!priceText) return 0;
            var v = priceText.replace(/[^0-9.]/g, '');
            return parseFloat(v || 0);
        }
        function formatPHP(amount) {
            try {
                return new Intl.NumberFormat('en-PH', { style: 'currency', currency: 'PHP' }).format(amount);
            } catch (e) {
                return 'â‚±' + Number(amount).toFixed(2);
            }
        }
        function saveCartToLocalStorage() {
            localStorage.setItem('cart', JSON.stringify(cart));
        }
        // DOM refs
        const cartOverlay = document.getElementById('cartOverlay');
        const cartSidebar = document.getElementById('cartSidebar');
        const cartItemsContainer = document.getElementById('cartItems');
        const cartCountEl = document.getElementById('cartCount');
        const cartSubtotalEl = document.getElementById('cartSubtotal');
        const closeCartBtn = document.getElementById('closeCartBtn');
        const checkoutBtn = document.getElementById('checkoutBtn');
        // find nav cart button (the one with image alt="Cart")
        function getNavCartButton() {
            const img = document.querySelector('img[alt="Cart"]');
            if (!img) return null;
            return img.closest('button');
        }
        function openCartSidebar() {
            cartOverlay.classList.add('show');
            cartSidebar.classList.add('open');
            document.body.style.overflow = 'hidden';
            cartSidebar.setAttribute('aria-hidden', 'false');
            cartOverlay.setAttribute('aria-hidden', 'false');
        }
        function closeCartSidebar() {
            cartOverlay.classList.remove('show');
            cartSidebar.classList.remove('open');
            document.body.style.overflow = '';
            cartSidebar.setAttribute('aria-hidden', 'true');
            cartOverlay.setAttribute('aria-hidden', 'true');
        }
        function renderCart() {
            cartItemsContainer.innerHTML = '';
            if (cart.length === 0) {
                const empty = document.createElement('div');
                empty.className = 'cart-empty';
                empty.textContent = 'Your cart is empty';
                cartItemsContainer.appendChild(empty);
                cartCountEl.textContent = 0;
                cartSubtotalEl.textContent = formatPHP(0);
                // ensure packaging row is hidden/zero when empty
                var pkgRow = document.getElementById('cartPackagingRow'); if(pkgRow) pkgRow.style.display='none';
                var totalRow = document.getElementById('cartTotalRow'); if(totalRow) totalRow.style.display='none';
                saveCartToLocalStorage();
                return;
            }
            let subtotal = 0;
            let totalQty = 0;
            cart.forEach((item, index) => {
                const qty = (typeof item.qty === 'number') ? item.qty : (typeof item.quantity === 'number' ? item.quantity : 1);
                subtotal += item.price * qty;
                totalQty += qty;
                const box = document.createElement('div');
                box.className = 'cart-item-box';
                const img = document.createElement('img');
                img.className = 'cart-item-img';
                img.src = item.image || 'IMAGE/NIKE1.png';
                img.alt = item.title || 'Product';
                const middle = document.createElement('div');
                middle.className = 'cart-item-middle';
                const title = document.createElement('div');
                title.className = 'cart-item-title';
                title.textContent = item.title + (item.preOrder ? ' (Pre-Order)' : '');
                const brand = document.createElement('div');
                brand.className = 'cart-item-brand';
                brand.textContent = item.brand;
                const size = document.createElement('div');
                size.className = 'cart-item-size';
                size.textContent = 'Size: ' + (item.size || '');
                const qtyControls = document.createElement('div');
                qtyControls.className = 'cart-quantity-controls';
                const lessenBtn = document.createElement('button');
                lessenBtn.className = 'qty-btn decrease';
                lessenBtn.setAttribute('data-index', index);
                const lessenImg = document.createElement('img');
                lessenImg.src = 'IMAGE/LessenBTN.png';
                lessenImg.alt = '-';
                lessenImg.style.width = '22px';
                lessenImg.style.height = '22px';
                lessenBtn.appendChild(lessenImg);
                const qtyText = document.createElement('span');
                qtyText.className = 'cart-item-qty';
                qtyText.textContent = qty;
                const addBtn = document.createElement('button');
                addBtn.className = 'qty-btn increase';
                addBtn.setAttribute('data-index', index);
                const addImg = document.createElement('img');
                addImg.src = 'IMAGE/AddBTN.png';
                addImg.alt = '+';
                addImg.style.width = '22px';
                addImg.style.height = '22px';
                addBtn.appendChild(addImg);
                qtyControls.appendChild(lessenBtn);
                qtyControls.appendChild(qtyText);
                qtyControls.appendChild(addBtn);
                middle.appendChild(title);
                middle.appendChild(brand);
                middle.appendChild(size);
                middle.appendChild(qtyControls);
                const removeBtn = document.createElement('button');
                removeBtn.className = 'cart-item-remove';
                removeBtn.setAttribute('data-index', index);
                const trashImg = document.createElement('img');
                trashImg.src = 'IMAGE/TrashIcon.png';
                trashImg.alt = 'Remove';
                trashImg.style.width = '18px';
                trashImg.style.height = '18px';
                removeBtn.appendChild(trashImg);
                const priceEl = document.createElement('div');
                priceEl.className = 'cart-item-price';
                priceEl.textContent = formatPHP(item.price * qty);
                box.appendChild(img);
                box.appendChild(middle);
                box.appendChild(removeBtn);
                box.appendChild(priceEl);
                cartItemsContainer.appendChild(box);
            });
            cartCountEl.textContent = totalQty;
            // compute packaging fee and totals
            var totals = { subtotal: subtotal, packaging: 0, total: subtotal };
            try{
                // Preferred: use helper if it's already loaded
                if(typeof window.getCartTotals === 'function'){
                    totals = window.getCartTotals(cart);
                } else {
                    // Fallback: compute packaging locally so fee appears even if cart-storage.js
                    // hasn't been loaded yet. Packaging: PHP50 per pair (every 2 items).
                    var totalItemsLocal = 0;
                    cart.forEach(function(item){ var q = (typeof item.qty==='number')?item.qty:((typeof item.quantity==='number')?item.quantity:1); totalItemsLocal += Number(q)||0; });
                    var pairsLocal = Math.floor(totalItemsLocal / 2);
                    var packagingLocal = pairsLocal * 50;
                    totals.subtotal = subtotal;
                    totals.packaging = packagingLocal;
                    totals.total = totals.subtotal + totals.packaging;
                    // attach helpful details for display
                    totals._pairs = pairsLocal;
                    totals._totalItems = totalItemsLocal;
                }
            }catch(e){ totals = { subtotal: subtotal, packaging: 0, total: subtotal }; }
            cartSubtotalEl.textContent = formatPHP(totals.subtotal);
            // create or update packaging row
            var pkgRow = document.getElementById('cartPackagingRow');
            if(!pkgRow){
                pkgRow = document.createElement('div'); pkgRow.id='cartPackagingRow'; pkgRow.className='cart-subtotal-row'; pkgRow.style.marginTop='6px';
                pkgRow.innerHTML = '<span class="cart-subtotal-label">Packaging Fee</span><span id="cartPackagingValue" class="cart-subtotal-value">â‚±0.00</span>';
                cartSubtotalEl.parentNode.parentNode.insertBefore(pkgRow, cartSubtotalEl.parentNode.nextSibling);
            }
            var pkgVal = document.getElementById('cartPackagingValue'); if(pkgVal) pkgVal.textContent = formatPHP(totals.packaging);
            // show explanation when packaging applies
            if(totals.packaging > 0){
                pkgRow.style.display = '';
                var expl = document.getElementById('cartPackagingExpl');
                if(!expl){ expl = document.createElement('div'); expl.id = 'cartPackagingExpl'; expl.style.fontSize='0.9rem'; expl.style.color='#666'; expl.style.marginTop='4px'; pkgRow.appendChild(expl); }
                var pairs = (typeof totals._pairs === 'number') ? totals._pairs : Math.floor((Number(cart.reduce(function(a,b){ var q=(typeof b.qty==='number')?b.qty:((typeof b.quantity==='number')?b.quantity:1); return a + (Number(q)||0); },0))) / 2);
                expl.textContent = 'Packaging fee: â‚±50 per pair. You have ' + (totals._totalItems || cart.reduce(function(a,b){ var q=(typeof b.qty==='number')?b.qty:((typeof b.quantity==='number')?b.quantity:1); return a + (Number(q)||0); },0)) + ' item(s) â†’ ' + pairs + ' pair(s).';
            } else {
                pkgRow.style.display = 'none';
            }
            // create or update total row
            var totalRow = document.getElementById('cartTotalRow');
            if(!totalRow){
                totalRow = document.createElement('div'); totalRow.id='cartTotalRow'; totalRow.className='cart-subtotal-row'; totalRow.style.marginTop='6px';
                totalRow.innerHTML = '<span class="cart-subtotal-label">Total</span><span id="cartTotalValue" class="cart-subtotal-value">â‚±0.00</span>';
                cartSubtotalEl.parentNode.parentNode.insertBefore(totalRow, cartSubtotalEl.parentNode.nextSibling.nextSibling);
            }
            // Cart modal should show only the shoes total (subtotal). Shipping/packaging handled at checkout.
            var totalVal = document.getElementById('cartTotalValue'); if(totalVal) totalVal.textContent = formatPHP(totals.subtotal);
            attachCartEvents();
        }
        function attachCartEvents() {
            // decrease
            document.querySelectorAll('.qty-btn.decrease').forEach(btn => {
                btn.onclick = function(e) {
                    const idx = parseInt(btn.getAttribute('data-index'), 10);
                    if (!isNaN(idx) && cart[idx]) {
                        // Use qty if present, else quantity
                        if (typeof cart[idx].qty === 'number') {
                            if (cart[idx].qty > 1) {
                                cart[idx].qty--;
                            }
                        } else if (typeof cart[idx].quantity === 'number') {
                            if (cart[idx].quantity > 1) {
                                cart[idx].quantity--;
                            }
                        }
                        renderCart();
                        saveCartToLocalStorage();
                    }
                };
            });
            // increase
            document.querySelectorAll('.qty-btn.increase').forEach(btn => {
                btn.onclick = function(e) {
                    const idx = parseInt(btn.getAttribute('data-index'), 10);
                    if (!isNaN(idx) && cart[idx]) {
                        if (typeof cart[idx].qty === 'number') {
                            cart[idx].qty++;
                        } else if (typeof cart[idx].quantity === 'number') {
                            cart[idx].quantity++;
                        }
                        renderCart();
                        saveCartToLocalStorage();
                    }
                };
            });
            // remove
            document.querySelectorAll('.cart-item-remove').forEach(btn => {
                btn.onclick = function(e) {
                    const idx = parseInt(btn.getAttribute('data-index'), 10);
                    if (!isNaN(idx)) {
                        cart.splice(idx, 1);
                        renderCart();
                        saveCartToLocalStorage();
                    }
                };
            });
        }
        // Hook nav cart button (remove its inline navigation and replace with open sidebar)
        document.addEventListener('DOMContentLoaded', function() {
            const navCartBtn = getNavCartButton();
            if (navCartBtn) {
                navCartBtn.removeAttribute('onclick');
                navCartBtn.addEventListener('click', function(e){
                    e.preventDefault();
                    openCartSidebar();
                });
            }
            // hook close buttons and overlay
            if (closeCartBtn) closeCartBtn.addEventListener('click', closeCartSidebar);
            if (cartOverlay) cartOverlay.addEventListener('click', closeCartSidebar);
            renderCart();
            if (checkoutBtn) {
                checkoutBtn.addEventListener('click', function(){
                    window.location.href = 'checkout.html';
                });
            }
        });
    })();
    </script>
    <script src="cart-storage.js"></script>
</body>
</html>
